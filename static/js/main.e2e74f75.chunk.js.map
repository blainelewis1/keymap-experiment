{"version":3,"sources":["data/ExiiConsentLetter.md","menus/DropdownMenu.js","menus/Shortcuts/ShortcutUtils.js","actions/shortcuts.js","Workflow.js","menus/Shortcuts/Shortcuts.js","menus/KeyMap/KeyMapConstants.js","menus/KeyMap/KeyMap.js","actions/menus.js","menus/Shortcuts/CommandHierarchies.js","menus/LinearMenuBar/LinearMenuBar.js","actions/tasks.js","layout/index.js","tasks/StimulusResponseTask.js","tasks/MouseCenteringTask.js","tasks/DisplayTextTask.js","actions/index.js","tasks/UploadToS3.js","tasks/GoogleFormQuestionnaire.js","Utils.js","data/newStimuli.js","design/GenerateConfiguration.js","tasks/ConsentForm.js","ExperimentProgress.js","tasks/KeyboardChooser.js","UploadOnError.js","layout/Snackbar.js","tasks/KeyMapTutorial.js","tasks/ExposeHKTutorial.js","App.js","tasks/InformationScreen.js","registerServiceWorker.js","reducers/configuration.js","reducers/shortcuts.js","reducers/menus.js","reducers/tasks.js","reducers/index.js","configureStore.js","index.js"],"names":["module","exports","DropdownMenu","onChange","this","handleChange","bind","props","menuItems","map","item","i","key","e","onCommand","target","value","Component","shortcutValues","control","shift","alt","meta","MODIFIERS","SHIFT_HELD_KEY_MAPPINGS","$","_","eventToKey","toLowerCase","isModifier","indexOf","chordArrayFromString","string","split","sort","compareShortcut","chordArrayToString","path","join","chordToPrettyString","chord","modifierToSymbol","length","toUpperCase","lookup","undefined","a","b","getModifiersFromChord","filter","getLetterFromChord","resetShortcuts","type","RESET_SHORTCUTS","TOGGLE_MODIFIER","SET_MODIFIER","ADD_TO_PATH","DELAY_OVER","getCurrentProps","configuration","nextLevelIndex","index","properties","Object","assign","nextLevel","children","advanceWorkflow","config","slice","advanceWorkflowLevelTo","level","newValue","log","withTimeStamp","timestamp","Date","now","logAction","action","actions","Shortcuts","handleVisibilityChange","document","hidden","onResetShortcuts","handleKeyboard","handleModifier","handleKey","preventDefault","addEventListener","onRef","removeEventListener","clearTimeout","delayTimeRunning","keys","modifiersPressed","modifier","onToggleModifier","onSetModifier","onDelayOver","getCurrentModifiers","delayTimeOver","setTimeout","delay","onModifiersChanged","currentHierarchy","reduce","prev","current","commandHierarchy","submenuOrCommand","command","onAddToPath","ConnectedShortcuts","connect","state","shortcuts","withRef","baseLayout","label","id","bottomRows","mac","symbol","keyName","macbook","windows","surface","layouts","mapValues","bottomRow","Key","submenu","pressed","onClick","color","faded","className","style","backgroundColor","Row","row","commandsAvailable","onKeyClick","keyConfig","KeyMapDisplay","layoutName","active","noop","classes","push","viewportWidth","Math","max","documentElement","clientWidth","window","innerWidth","layout","transform","KeyMap","resize","throttle","forceUpdate","React","createRef","onClose","modifiersPressedString","m","demo","Fragment","ref","handleKeyClick","stopPropagation","nativeEvent","stopImmediatePropagation","wrappedInstance","OPEN_MENU","OPEN_ALL_MENUS","CLOSE_ALL_MENUS","mergeCommandHierarchy","left","right","keyFixed","menuToCommandHierarchy","menus","forEach","menu","others","items","shortcut","modifiers","letter","hierarchies","icon","u","space","backslash","c","v","k","f","h","o","t","n","l","r","j","y","x","z","q","w","LinearItem","shortcutToPrettyString","LinearMenu","open","title","onItemClick","onMenuClick","onMouseEnter","menuItem","LinearMenuBarDisplay","allOpen","openMenu","LinearMenuBar","handleMenuClick","menuTitle","onCloseAllMenus","onOpenMenu","handleItemClick","handleMouseEnter","values","some","onOpenAllMenus","exposeHK","allMenusOpen","PureComponent","LinearMenuBarConnected","ExposeHK","HIDE_STIMULUS","SHOW_STIMULUS","CenteredPaper","styled","Paper","axis","top","width","CenteredText","div","OuterProgress","InnerProgress","Progress","stimulusTypes","ImageStimulus","stimulus","stimulusImageExtension","stimulusImagePath","position","Stimulus","src","TextStimulus","borderColor","border","StimulusResponseTask","redScreen","Menu","StimulusType","stimulusType","withNext","onAdvanceWorkflow","showStimulus","validateSelection","getTime","time","delayOnError","delayOver","clicked","onLog","JSON","stringify","flashOnError","setState","continueOnError","onHideStimulus","onErrorTimeout","interval","setInterval","onShowStimulus","clearInterval","ConnectedStimulusResponseTask","tasks","Content","span","MouseCenterer","MouseCenteringTask","mouseOver","handleClick","hasClicked","buttonRef","box","getBoundingClientRect","mousex","mousey","bottom","content","innerRef","onMouseOver","onMouseOut","DisplayTextTask","displayedText","variant","ADVANCE_WORKFLOW_LEVEL_TO","LOG","ADVANCE_WORKFLOW","LOG_ACTION","EDIT_CONFIG","UploadToS3Display","contents","error","participant","experimenter","href","download","size","UploadToS3","AWS","region","AWS_REGION","credentials","CognitoIdentityCredentials","IdentityPoolId","AWS_COGNITO_IDENTITY_POOL_ID","s3","S3","apiVersion","params","Bucket","AWS_S3_BUCKET","fireAndForget","attemptUploadWithRetries","retries","logs","events","uploadJSONFile","s3FileName","then","done","catch","err","fileName","data","Promise","resolve","reject","upload","Body","ContentType","ACL","mapDispatchToProps","handleLoad","hasLoaded","prefillParticipant","formId","height","frameBorder","marginHeight","marginWidth","onLoad","shuffle","floor","random","randomChoice","randomChoiceNoReplacement","choice","splice","newMenus","vegetables","itemsFromMenu","flatMap","compoundTask","biggest","task","Array","isArray","fill","result","zip","taskInstances","URL","location","searchParams","session","get","worker_id","assignment_id","hit_id","seed","seedrandom","global","cloneDeep","backmap","animals","fruits","office","clothing","recreation","letters","pop","truncatedZipfian","allKeys","inBackMap","center","top3","remove","frequencies","stimuli","categories","stimuliShortcuts","stimuliCommands","recallStim","flatten","frequency","rank","wasAsked","confirmationCode","toString","substring","extraCommands","difference","tutorial","fullProgress","currentProgress","progressLevel","recallTask","selectionTasks","condition","mturk","browser","browserName","navigator","appName","browserEngine","product","browserVersion1a","appVersion","browserVersion1b","userAgent","browserLanguage","language","browserOnline","onLine","browserPlatform","platform","sizeScreenW","screen","sizeScreenH","sizeDocW","sizeDocH","sizeInW","sizeInH","innerHeight","sizeAvailW","availWidth","sizeAvailH","availHeight","scrColorDepth","colorDepth","scrPixelDepth","pixelDepth","group","name","clientHeight","os","ExiiConsentLetter","questions","required","noProgress","withContinue","addBetweenArray","generateRandomParticipant","arr","elem","end","child","added","ConsentForm","event","checked","handleSubmit","requiredFieldNotFilled","question","val","display","dangerouslySetInnerHTML","__html","marked","onAdvanceWorkflowLevelTo","indices","curIndex","newIndex","progressSections","sections","progress","cur","getCurrentChild","getAllChildren","activeStep","cursor","sum","KeyboardChooser","entries","entry","marginBottom","onEditConfig","UploadOnError","hasError","info","getOwnPropertyNames","variantIcon","success","warning","MySnackbarContentWrapper","withStyles","theme","green","palette","dark","primary","amber","fontSize","iconVariant","opacity","marginRight","spacing","unit","message","alignItems","other","classNames","aria-describedby","aria-label","close","CustomizedSnackbars","handleClose","reason","margin","anchorOrigin","vertical","horizontal","autoHideDuration","Tutorial","nextProps","step","steps","component","orientation","text","errorMessage","KeyMapPointerTutorial","keyHandler","globalClick","keyClick","KeyMapGuidedTutorial","delayTimeout","KeyMapShortcutTutorial","repeat","ExposeHKPointerTutorial","errorDisplay","ExposeHKGuidedTutorial","ExposeHKShortcutTutorial","GoogleFormQuestionnaire","InformationScreen","nTimes","Task","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","combineReducers","saveState","localStorage","setItem","store","storedState","getItem","parse","loadState","createStore","reducer","subscribe","getState","dispatch","configureStore","Main","ReactDOM","render","StrictMode","getElementById","process","origin","fetch","response","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","clientX","clientY","logEvent","passive","loaded","transformEvent","pick"],"mappings":"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","file":"static/js/main.e2e74f75.chunk.js","sourcesContent":["module.exports = \"# Information Consent Letter for Online Studies\\n\\n**Title of the study: Evaluation of Human-Computer Interaction Techniques**\\n\\n_Principal Investigator/Faculty Supervisor:_ Dr. Daniel Vogel, Assistant Professor, School of Computer Science, University of Waterloo, Canada, 519-888-4567 ext. 33561, dvogel@uwaterloo.ca\\n\\nGraduate Student Investigators:\\n\\n- Blaine Lewis, b2lewis@uwaterloo.ca\\n- Greg d’Eon, gldeon@uwaterloo.ca\\n\\nTo help you make an informed decision regarding your participation, this letter will explain what the study is about, the possible risks and benefits, and your rights as a research participant.\\n\\n## What is the study about?\\n\\nYou are invited to participate in a research study examining methods for people to interact with computers and other digital devices. In this experiment, you will issue computer application commands using a variety of methods such as menus, toolbars, and keyboard shortcuts. This is important because understanding the characteristics and performance of human-computer interaction can discover new interaction methods and improve existing interaction methods. The results of this study contribute to graduate theses and faculty research.\\n\\n## 1. Your responsibilities as a participant\\n\\n### What does participation involve?\\n\\nParticipation in the study will consist of a 10-minute-long session. In certain cases, you will also be asked to participate in one or more shorter follow-up sessions (each 24 to 48 hours after the previous session). During a session, you be asked to perform typical laptop tasks like typing and clicking while intermittently issuing commands using a specific graphical user interface or device input method.\\n\\nDuring the experiment, you may also be asked for your opinion of the techniques and tasks regarding factors such as overall preference, fatigue, comfort, speed, accuracy, utility, suitability, etc. You may decline to respond to questions if you wish. If you wish to decline a written question, leave it blank.\\n\\nYour computer interactions will also be captured and stored in a computer log file.\\n\\n### Who may participate in the study?\\n\\nIn order to participate in the study: you must be able to enter text on a computer and control a computer cursor using a mouse, touchpad, or similar pointing device.\\n\\n## 2. Your rights as a participant\\n\\n### What are the possible benefits of the study?\\n\\nParticipation in this study may not provide any personal benefit to you. The study will benefit the academic community and society in general by contributing a better understanding of human-computer interaction and potentially inventing new methods of interaction.\\n\\n### Will I receive payment for participating in the study?\\n\\nIn appreciation of your time, you will receive $2.50 for the first session and $1 for the followup session. If you begin a session but decide to withdraw, your participation in the study will end and you will be remunerated for the proportion of what you completed, up to half the full session remuneration. Please contact Blaine Lewis <blaine.lewis@uwaterloo.ca> or Greg d’Eon <gldeon@uwaterloo.ca> for instructions to receive partial remuneration if you withdraw.\\n\\n### What are the risks associated with the study?\\n\\nThere is potential for minor discomfort or fatigue from performing repeated tasks, but the physical requirements of the task are like normal computer usage and/or common real-world tasks. We will minimize this risk by requiring and/or encouraging rest breaks.\\n\\nThe study server is hosted by Amazon, when information is transmitted or stored on the internet, privacy cannot be guaranteed. There is always a risk your responses may be intercepted by a third party (e.g., government agencies, hackers).\\n\\n### Is participation in the study voluntary?\\n\\nYour participation in this study is voluntary. You may decide to withdraw from the study at any time by communicating this to the researcher.\\n\\n### Will my identity be known?\\n\\nThe research team will know which data is from your participation, but all data will be anonymized for analysis, reporting, and public data sharing.\\n\\n### Will my information be kept confidential?\\n\\nThere will be no association between your identify and the research data as you are not asked to provide your name or any identifying information. In all cases, participants will only be referred to using generic labels (P1, P2, …) or collectively as a group (Group A, Group B,…). The research data will be accessible by the study investigators as well as the broader scientific community. More specifically, the data may be posted on public databases and/or made available to other researchers upon publication, so that data may be inspected and analyzed by other researchers. The data that will be shared will not contain any information that could be used to identify you (e.g., worker ID).\\n\\n## 3. Questions, comments, or concerns\\n\\n### Who is sponsoring/funding this study?\\n\\nThis study is funded/sponsored by the Natural Sciences and Engineering Research Council of Canada (NSERC), the Province of Ontario, and the University of Waterloo.\\n\\n### Has the study received ethics clearance?\\n\\nThis study has been reviewed and received ethics clearance through a University of Waterloo Research Ethics Committee (ORE# 22114). If you have questions for the Committee contact the Office of Research Ethics at 1-519-888-4567 ext. 36005 or ore-ceo@uwaterloo.ca.\\n\\n### Who should I contact if I have questions regarding my participation in the study?\\n\\nIf you have any questions regarding this study, or would like additional information to assist you in reaching a decision about participation, please contact Blaine Lewis <blaine.lewis@uwaterloo.ca> or Greg d’Eon <gldeon@uwaterloo.ca> or Dr. Daniel Vogel at 516.888.4567 x33561 or by email at dvogel@uwaterloo.ca. You can also contact any member of the research team listed at the top of this consent letter.\\n\\n## Consent Form\\n\\nBy providing your consent, you are not waiving your legal rights or releasing the investigator(s) or involved institution(s) from their legal and professional responsibilities.\\n\\nI have read the information presented above about a study led by Dr. Daniel Vogel, School of Computer Science, University of Waterloo, Canada. I have had the opportunity to contact the investigators with questions related to the study and have received satisfactory answers to my questions and any additional details.\\n\\nI was informed that participation in the study is voluntary and that I can withdraw this consent by informing the researcher.\\n\"","import React, { Component } from \"react\";\n\nexport default class DropdownMenu extends Component {\n  render() {\n    return (\n      <select onChange={this.handleChange.bind(this)}>\n        {this.props.menuItems.map((item, i) => <option key={i}>{item}</option>)}\n      </select>\n    );\n  }\n\n  handleChange(e) {\n    this.props.onCommand(e.target.value);\n  }\n}\n","const shortcutConversions = {\n  // control: \"⌃\",\n  // shift: \"⇧\",\n  // alt: \"⌥\",\n  // meta: \"⌘\"\n};\n\nconst shortcutValues = {\n  control: 1,\n  shift: 3,\n  alt: 2,\n  meta: 4\n};\n\nexport const MODIFIERS = [\"control\", \"meta\", \"shift\", \"alt\", \"fn\"];\nconst SHIFT_HELD_KEY_MAPPINGS = {\n  \"<\": \",\",\n  \">\": \".\",\n  \"?\": \"/\",\n  \":\": \";\",\n  '\"': \"'\",\n  \"{\": \"[\",\n  \"}\": \"]\",\n  \"|\": \"\\\\\",\n\n  \"~\": \"`\",\n  \"!\": \"1\",\n  \"@\": \"2\",\n  \"#\": \"3\",\n  $: \"4\",\n  \"%\": \"5\",\n  \"^\": \"6\",\n  \"&\": \"7\",\n  \"*\": \"8\",\n  \"(\": \"9\",\n  \")\": \"0\",\n  _: \"-\",\n  \"+\": \"=\"\n};\n\n/**\n * Takes a keyboard event and returns a unique key mapping. Handles keys that\n * return differently if shift is held.\n *\n * @param {KeyboardEvent} e\n * @returns {String} keyId\n */\nexport function eventToKey(e) {\n  return SHIFT_HELD_KEY_MAPPINGS[e.key] || e.key.toLowerCase();\n}\n\n/**\n * Returns true if the key is a modifier key.\n *\n * @param {String} key\n */\nexport function isModifier(key) {\n  return MODIFIERS.indexOf(key) > -1;\n}\n\n/**\n * Given a string of commands like \"ctrl+g\" returns an array of the paths\n * in a sorted fashion\n *\n * @param {string} string\n * @returns {Array<String>} path\n */\nexport function chordArrayFromString(string) {\n  return string.split(\"+\").sort(compareShortcut);\n}\n\n/**\n * Converts a path of keys like [ctrl, g] into a sorted string.\n *\n * @param {Array<String>} path\n * @returns {String}\n */\nexport function chordArrayToString(path) {\n  path.sort(compareShortcut);\n  return path.join(\"+\");\n}\n\nexport function shortcutToPrettyString(shortcut) {\n  return shortcut.map(chordToPrettyString).join(\",\");\n}\n\nexport function chordToPrettyString(chord) {\n  chord.sort(compareShortcut);\n  chord = chord.map(modifierToSymbol);\n  chord[chord.length - 1] = chord[chord.length - 1].toUpperCase();\n  return chord.join(\"+\");\n}\n\nexport const modifierToSymbol = convertItem.bind(\n  undefined,\n  shortcutConversions\n);\n\nexport function convertItem(lookup, item) {\n  return lookup[item] || item;\n}\n\nexport function compareShortcut(a, b) {\n  if (a === b) {\n    return 0;\n  } else if (a in shortcutValues) {\n    if (b in shortcutValues) {\n      return shortcutValues[a] - shortcutValues[b];\n    } else {\n      return -1;\n    }\n  } else {\n    return 1;\n  }\n}\n\nexport function getModifiersFromChord(chord) {\n  return chord.filter(isModifier);\n}\n\nexport function getLetterFromChord(chord) {\n  return chord.filter(chord => !isModifier(chord))[0];\n}\n","export const toggleModifier = modifier => ({\n  type: TOGGLE_MODIFIER,\n  modifier\n});\n\nexport const setModifier = (modifier, value) => ({\n  type: SET_MODIFIER,\n  modifier,\n  value\n});\n\nexport const resetShortcuts = () => ({\n  type: RESET_SHORTCUTS\n});\n\nexport const addToPath = keys => ({\n  type: ADD_TO_PATH,\n  keys\n});\n\nexport const delayOver = keys => ({\n  type: DELAY_OVER\n});\n\nexport const TOGGLE_MODIFIER = \"TOGGLE_MODIFIER\";\nexport const SET_MODIFIER = \"SET_MODIFIER\";\nexport const RESET_SHORTCUTS = \"RESET_SHORTCUTS\";\nexport const ADD_TO_PATH = \"ADD_TO_PATH\";\nexport const DELAY_OVER = \"DELAY_OVER\";\n","// An experiment configuration object looks like this (for example):\n// let configuration = {\n//   your_props: your_values,\n//   current: {key: \"sections\", value: 0},\n//   sections: [\n//     {\n//       your_section_props: your_values,\n//       current: {key: \"blocks\", value: 0},\n//       blocks: [\n//         {\n//           your_block_props: your_values,\n//           current: {key: \"trials\", value: 0},\n//           trials: [\n//             {\n//               your_trial_props: your_values,\n//             },\n//             {\n//               your_trial_props: your_values,\n//             }\n//           ],\n//         }\n//       ],\n//     }\n//   ],\n// }\n//\n// Each level of the configuration (except for the leaves) must have at least 2 elements:\n// - current: Describes where the participant is in the experiment. Contains a key (the name of a list) and a value (the current index in the list).\n// - current.key: A list of pieces of the experiment.\n// All other props are provided as inputs to the experiment components.\n// Props at the higher levels are overridden by props with the same name at lower levels. For example, a \"speed\" prop inside one of the \"blocks\" objects would take precedence over a \"speed\" prop in the \"sections\" object.\n\n//TODOLATER: Convert getcurrentprops into a \"selector\" function\n//TODOLATER: next level should be optional so this should use children I think.\n\n// Flatten the experiment props down to a given level.\n// Returns a list of all flattened configurations.\nexport function flattenToLevel(config, level) {\n  if (\"nextLevel\" in config) {\n    // Find our properties\n    let properties = Object.assign({}, config);\n    delete properties.children;\n    delete properties.nextLevel;\n    delete properties.index;\n\n    // Get the flattened lists\n    let flattenedConfigList;\n    if (config.nextLevel === level) {\n      // Base case: we're at the right level\n      // Just grab the list of configs below us\n      flattenedConfigList = config.children;\n    } else {\n      // Recursive case: go deeper\n      flattenedConfigList = [];\n      config.children.forEach(subConfig =>\n        flattenedConfigList.push(...flattenToLevel(subConfig, level))\n      );\n    }\n\n    // Apply our properties\n    return flattenedConfigList.map(subConfig => {\n      let propertiesClone = Object.assign({}, properties);\n      return Object.assign(propertiesClone, subConfig);\n    });\n  } else {\n    // Edge case: we've run out of levels to flatten\n    // Return a list with the entire config in it\n    return [config];\n  }\n}\n\nexport function getIndexFromValue(config, level) {\n  config.children.map(getIndexFromValue);\n\n  if (config.level === level) {\n    return { ...config, config };\n  }\n}\n\n// Get a flattened list of props for this trial of the experiment.\nexport function getCurrentProps(configuration, props = {}) {\n  // Error catching: if we're finished the experiment, return undefined\n  if (!configuration) {\n    return undefined;\n  }\n\n  // Recursive case: return the union of the props at this level and the props at the next level\n  // Prop values at this level are overwritten by values in the next level\n  if (\"nextLevel\" in configuration) {\n    const nextLevelIndex = configuration.index || 0;\n\n    let properties = Object.assign({}, configuration);\n    delete properties.nextLevel;\n    delete properties.index;\n    delete properties.children;\n    properties = Object.assign(props, properties);\n\n    return getCurrentProps(configuration.children[nextLevelIndex], properties);\n  }\n  // Base case: return all of the props\n  else {\n    return Object.assign(props, configuration);\n  }\n}\n\n// Move on to the next step of the workflow.\n// Returns true if the participant has finished all the steps in this part of the configuration.\nexport function advanceWorkflow(config) {\n  // Error catching: if we went past the end of a list, don't keep advancing\n  if (!config) {\n    return false;\n  }\n\n  // Recursive case: move through this level's stage list\n  // If we reach the end, return true so that the level above this knows we're finished\n  if (\"nextLevel\" in config) {\n    const nextLevelIndex = config.index || 0;\n    config.children = [\n      ...config.children.slice(0, nextLevelIndex),\n      {\n        ...config.children[nextLevelIndex]\n      },\n      ...config.children.slice(nextLevelIndex + 1)\n    ];\n\n    if (advanceWorkflow(config.children[nextLevelIndex])) {\n      config.index = nextLevelIndex + 1;\n      return config.index >= config.children.length;\n    }\n  }\n  // Base case: at a leaf node, we don't have a list of steps, so we're always done\n  else {\n    return true;\n  }\n}\n\n// Returns true if the participant has finished all the steps in this part of the configuration.\nexport function advanceWorkflowLevelTo(config, level, newValue) {\n  // Error catching: if we went past the end of a list, don't keep advancing\n  if (!config) {\n    return false;\n  }\n\n  if (config[\"nextLevel\"] === level) {\n    config.index = newValue;\n  } else if (config.children) {\n    return { ...advanceWorkflowLevelTo(config.children[config.index]) };\n  }\n}\n\nexport function log(config, key, value, withTimeStamp) {\n  while (\"nextLevel\" in config) {\n    const nextLevelIndex = config.index || 0;\n\n    config.children = [\n      ...config.children.slice(0, nextLevelIndex),\n      {\n        ...config.children[nextLevelIndex]\n      },\n      ...config.children.slice(nextLevelIndex + 1)\n    ];\n    config = config.children[nextLevelIndex];\n  }\n  if (withTimeStamp) {\n    config[key] = {\n      value: value,\n      timestamp: Date.now()\n    };\n  } else {\n    config[key] = value;\n  }\n}\n\nexport function logAction(config, action) {\n  while (\"nextLevel\" in config) {\n    const nextLevelIndex = config.index || 0;\n\n    config.children = [\n      ...config.children.slice(0, nextLevelIndex),\n      {\n        ...config.children[nextLevelIndex]\n      },\n      ...config.children.slice(nextLevelIndex + 1)\n    ];\n    config = config.children[nextLevelIndex];\n  }\n\n  if (!config.actions) {\n    config.actions = [];\n  }\n  config.actions = [\n    ...config.actions,\n    {\n      action: action,\n      timestamp: Date.now()\n    }\n  ];\n}\n","import { Component } from \"react\";\nimport { eventToKey, isModifier } from \"./ShortcutUtils\";\nimport { chordArrayToString } from \"../Shortcuts/ShortcutUtils\";\nimport { connect } from \"react-redux\";\nimport {\n  toggleModifier,\n  setModifier,\n  resetShortcuts,\n  addToPath,\n  delayOver\n} from \"../../actions/shortcuts\";\nimport { getCurrentProps } from \"../../Workflow\";\n\n//TODOLATER: right now keyboard isn't reset when changing focus to the developer console or soemthing, just when not visible\n//FIXMELATER: currently it only takes valid, sorted hierarchies.\n//TODOLATER: should it always try to convert a menu to a command hierarchy? could set an instance letiable and always reference that, merge the command hierarchy with the menu converted one.\n\nexport class Shortcuts extends Component {\n  render() {\n    return null;\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.handleKeyboard, false);\n    document.addEventListener(\"keydown\", this.handleKeyboard, false);\n    document.addEventListener(\"visibilitychange\", this.handleVisibilityChange);\n\n    if (this.props.onRef) {\n      this.props.onRef(this);\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.handleKeyboard, false);\n    document.removeEventListener(\"keydown\", this.handleKeyboard, false);\n    document.removeEventListener(\n      \"visibilitychange\",\n      this.handleVisibilityChange\n    );\n\n    this.props.onResetShortcuts();\n    clearTimeout(this.delayTimeRunning);\n  }\n\n  handleVisibilityChange = () => {\n    if (document.hidden) {\n      this.props.onResetShortcuts();\n    }\n  };\n\n  getCurrentModifiers() {\n    return Object.keys(this.props.modifiersPressed)\n      .filter(key => this.props.modifiersPressed[key])\n      .sort();\n  }\n\n  handleKeyboard = e => {\n    let key = eventToKey(e);\n\n    if (isModifier(key)) {\n      this.handleModifier(key, e.type);\n    } else {\n      this.handleKey(key, e.type);\n    }\n\n    if (e.preventDefault) {\n      e.preventDefault();\n    }\n  };\n\n  handleModifier(modifier, type) {\n    if (type === \"click\") {\n      this.props.onToggleModifier(modifier);\n    } else {\n      this.props.onSetModifier(modifier, type === \"keydown\");\n    }\n\n    //TODOLATER: this might not be ideal, what happens if I am in the middle of a submenu and want to cancel. The next command I enter will be from the submenu. This needs a timeout.\n\n    //TODOLATER: do we need to reset if no modifiers are pressed?\n    // if (this.props.path.length + this.getCurrentModifiers().length === 0) {\n    //   this.props.onResetShortcuts();\n    // }\n\n    if (type === \"click\") {\n      this.props.onDelayOver();\n    } else if (this.getCurrentModifiers().length) {\n      if (!this.props.delayTimeOver && !this.delayTimeRunning) {\n        this.delayTimeRunning = setTimeout(\n          this.props.onDelayOver,\n          this.props.delay\n        );\n      }\n    } else {\n      clearTimeout(this.delayTimeRunning);\n      delete this.delayTimeRunning;\n    }\n\n    if (this.props.onModifiersChanged) {\n      this.props.onModifiersChanged();\n    }\n  }\n\n  handleKey(key, type) {\n    if (key === \" \") {\n      return;\n    }\n    // Handles if a command was issued and the letter wasn't released.\n    if (type === \"keydown\" || type === \"click\") {\n      // It's a regular key\n      const currentHierarchy = this.props.path.reduce(\n        (prev, current) => prev[current],\n        this.props.commandHierarchy\n      );\n\n      if (!currentHierarchy) {\n        return;\n      }\n\n      const submenuOrCommand =\n        currentHierarchy[chordArrayToString(this.getCurrentModifiers())] &&\n        currentHierarchy[chordArrayToString(this.getCurrentModifiers())][key];\n\n      if (submenuOrCommand === undefined) {\n        // No command under that selection....\n        // This shortcut is not a command or submenu\n\n        this.props.onResetShortcuts();\n        this.props.onCommand(null);\n      } else if (\"command\" in submenuOrCommand) {\n        // This was a command not a submenu\n\n        //TODOLATER: make events fire manually when clicking.\n        // if (type === \"click\") {\n        //   this.detachFromWindow();\n        //   window.dispatchEvent(new KeyboardEvent());\n        //   window.dispatchEvent(new KeyboardEvent());\n        //   this.attachToWindow();\n        // }\n        this.props.onCommand(\n          submenuOrCommand.command,\n          this.props.delayTimeOver,\n          type\n        );\n        this.props.onResetShortcuts();\n      } else {\n        // submenu, and we add current path to the entered path\n        this.props.onAddToPath(chordArrayToString(this.getCurrentModifiers()));\n        this.props.onAddToPath(key);\n      }\n    }\n  }\n}\n\nconst ConnectedShortcuts = connect(\n  state => {\n    let configuration = getCurrentProps(state.configuration);\n    return { ...state.shortcuts, ...configuration };\n  },\n  {\n    onResetShortcuts: resetShortcuts,\n    onToggleModifier: toggleModifier,\n    onSetModifier: setModifier,\n    onAddToPath: addToPath,\n    onDelayOver: delayOver\n  },\n  undefined,\n  { withRef: true }\n)(Shortcuts);\n\nexport default ConnectedShortcuts;\n","import { mapValues } from \"lodash\";\n\nexport const baseLayout = [\n  [\n    { label: \"`\" },\n    { label: \"1\" },\n    { label: \"2\" },\n    { label: \"3\" },\n    { label: \"4\" },\n    { label: \"5\" },\n    { label: \"6\" },\n    { label: \"7\" },\n    { label: \"8\" },\n    { label: \"9\" },\n    { label: \"0\" },\n    { label: \"-\" },\n    { label: \"=\" },\n    { label: \"delete\" }\n  ],\n  [\n    { label: \"tab\" },\n    { label: \"q\", type: \"letter\" },\n    { label: \"w\", type: \"letter\" },\n    { label: \"e\", type: \"letter\" },\n    { label: \"r\", type: \"letter\" },\n    { label: \"t\", type: \"letter\" },\n    { label: \"y\", type: \"letter\" },\n    { label: \"u\", type: \"letter\" },\n    { label: \"i\", type: \"letter\" },\n    { label: \"o\", type: \"letter\" },\n    { label: \"p\", type: \"letter\" },\n    { label: \"[\", id: \"left-square-bracket\" },\n    { label: \"]\", id: \"right-square-bracket\" },\n    { label: \"\\\\\", id: \"backslash\" }\n  ],\n  [\n    { label: \"caps lock\", id: \"caps-lock\" },\n    { label: \"a\", type: \"letter\" },\n    { label: \"s\", type: \"letter\" },\n    { label: \"d\", type: \"letter\" },\n    { label: \"f\", type: \"letter\" },\n    { label: \"g\", type: \"letter\" },\n    { label: \"h\", type: \"letter\" },\n    { label: \"j\", type: \"letter\" },\n    { label: \"k\", type: \"letter\" },\n    { label: \"l\", type: \"letter\" },\n    { label: \";\" },\n    { label: \"'\" },\n    { label: \"return\" }\n  ],\n  [\n    { label: \"shift\", id: \"left-shift\", type: \"modifier\" },\n    { label: \"z\", type: \"letter\" },\n    { label: \"x\", type: \"letter\" },\n    { label: \"c\", type: \"letter\" },\n    { label: \"v\", type: \"letter\" },\n    { label: \"b\", type: \"letter\" },\n    { label: \"n\", type: \"letter\" },\n    { label: \"m\", type: \"letter\" },\n    { label: \",\" },\n    { label: \".\" },\n    { label: \"/\" },\n    { label: \"shift\", id: \"right-shift\" }\n  ]\n];\n\nexport const macbookBottomRow = [\n  { label: \"fn\", type: \"modifier\" },\n  { label: \"control\", symbol: \"⌃\", type: \"modifier\" },\n  {\n    label: \"option\",\n    id: \"left-option\",\n    keyName: \"alt\",\n    symbol: \"⌥\",\n    type: \"modifier\"\n  },\n  {\n    label: \"command\",\n    id: \"left-command\",\n    keyName: \"meta\",\n    symbol: \"⌘\",\n    type: \"modifier\"\n  },\n  { label: \" \", id: \"space\" },\n  { label: \"command\", id: \"right-command\", keyName: \"meta\", symbol: \"⌘\" },\n  { label: \"option\", id: \"right-option\", keyName: \"alt\", symbol: \"⌥\" },\n  {\n    label: \"\",\n    symbol: \"◀\",\n    type: \"arrow\",\n    id: \"left-arrow\",\n    keyName: \"arrowleft\"\n  },\n  {\n    label: \"\",\n    symbol: \"▲\\n▼\",\n    id: \"vertical-arrow\",\n    type: \"arrow\"\n  },\n  {\n    label: \"\",\n    symbol: \"▶\",\n    type: \"arrow\",\n    id: \"right-arrow\",\n    keyName: \"arrowright\"\n  }\n];\n\nexport const macBottomRow = [\n  { label: \"control\", symbol: \"⌃\", type: \"modifier\" },\n  {\n    label: \"option\",\n    id: \"left-option\",\n    keyName: \"alt\",\n    symbol: \"⌥\",\n    type: \"modifier\"\n  },\n  {\n    label: \"command\",\n    id: \"left-command\",\n    keyName: \"meta\",\n    symbol: \"⌘\",\n    type: \"modifier\"\n  },\n  { label: \" \", id: \"space\" },\n  { label: \"command\", id: \"right-command\", keyName: \"meta\", symbol: \"⌘\" },\n  { label: \"option\", id: \"right-option\", keyName: \"alt\", symbol: \"⌥\" },\n  {\n    label: \"\",\n    symbol: \"◀\",\n    type: \"arrow\",\n    id: \"left-arrow\",\n    keyName: \"arrowleft\"\n  },\n  {\n    label: \"\",\n    symbol: \"▲\\n▼\",\n    id: \"vertical-arrow\",\n    type: \"arrow\"\n  },\n  {\n    label: \"\",\n    symbol: \"▶\",\n    type: \"arrow\",\n    id: \"right-arrow\",\n    keyName: \"arrowright\"\n  }\n];\n\nexport const windowsBottomRow = [\n  { label: \"ctrl\", type: \"modifier\", keyName: \"control\" },\n  {\n    label: \"\",\n    id: \"left-meta\",\n    type: \"modifier\",\n    symbol: \"⊞\"\n  },\n  {\n    label: \"alt\",\n    id: \"left-alt\",\n    keyName: \"alt\",\n    type: \"modifier\"\n  },\n  { label: \" \", id: \"space\" },\n  {\n    label: \"alt\",\n    id: \"right-alt\",\n    keyName: \"alt\"\n  },\n  { label: \"\", id: \"right-meta\", keyName: \"meta\", symbol: \"⊞\" },\n  { label: \"\", id: \"context\", symbol: \"≣\" },\n  { label: \"ctrl\", id: \"right-ctrl\", keyName: \"meta\" }\n];\n\nexport const windowsLaptopBottomRow = [\n  { label: \"ctrl\", type: \"modifier\", keyName: \"control\" },\n  { label: \"fn\", type: \"modifier\" },\n  {\n    label: \"\",\n    symbol: \"⊞\",\n    id: \"left-meta\",\n    type: \"modifier\"\n  },\n  {\n    label: \"alt\",\n    id: \"left-alt\",\n    keyName: \"alt\",\n    type: \"modifier\"\n  },\n  { label: \" \", id: \"space\" },\n  {\n    label: \"alt\",\n    id: \"right-alt\",\n    keyName: \"alt\"\n  },\n  { label: \"\", id: \"context\", symbol: \"≣\" },\n  { label: \"ctrl\", id: \"right-ctrl\", keyName: \"ctrl\" },\n  {\n    label: \"\",\n    symbol: \"◀\",\n    type: \"arrow\",\n    id: \"left-arrow\",\n    keyName: \"arrowleft\"\n  },\n  {\n    label: \"\",\n    symbol: \"▲\\n▼\",\n    id: \"vertical-arrow\",\n    type: \"arrow\"\n  },\n  {\n    label: \"\",\n    symbol: \"▶\",\n    type: \"arrow\",\n    id: \"right-arrow\",\n    keyName: \"arrowright\"\n  }\n];\n\nexport const surfaceBottomRow = [\n  { label: \"ctrl\", type: \"modifier\", keyName: \"control\" },\n  { label: \"fn\", type: \"modifier\" },\n  {\n    label: \"\",\n    symbol: \"⊞\",\n    id: \"left-meta\",\n    type: \"modifier\"\n  },\n  {\n    label: \"alt\",\n    id: \"left-alt\",\n    keyName: \"alt\",\n    type: \"modifier\"\n  },\n  { label: \" \", id: \"space\" },\n  {\n    label: \"alt\",\n    id: \"right-alt\",\n    keyName: \"alt\"\n  },\n  { label: \"\", id: \"context\", symbol: \"≣\" },\n  {\n    label: \"\",\n    symbol: \"◀\",\n    type: \"arrow\",\n    id: \"left-arrow\",\n    keyName: \"arrowleft\"\n  },\n  {\n    label: \"\",\n    symbol: \"▲\\n▼\",\n    id: \"vertical-arrow\",\n    type: \"arrow\"\n  },\n  {\n    label: \"\",\n    symbol: \"▶\",\n    type: \"arrow\",\n    id: \"right-arrow\",\n    keyName: \"arrowright\"\n  }\n];\n\nexport const bottomRows = {\n  mac: macBottomRow,\n  macbook: macbookBottomRow,\n  windows: windowsBottomRow,\n  \"windows-laptop\": windowsLaptopBottomRow,\n  surface: surfaceBottomRow\n};\n\nexport const layouts = mapValues(bottomRows, bottomRow => [\n  ...baseLayout,\n  bottomRow\n]);\n","import React from \"react\";\n\nimport Shortcuts from \"../Shortcuts/Shortcuts\";\nimport { chordArrayToString } from \"../Shortcuts/ShortcutUtils\";\n\nimport { connect } from \"react-redux\";\nimport { getCurrentProps } from \"../../Workflow\";\nimport { layouts } from \"./KeyMapConstants\";\nimport { resetShortcuts } from \"../../actions/shortcuts\";\nimport { throttle, noop } from \"lodash\";\nimport \"./KeyMap.css\";\n\n//TODOLATER: Include command icon?\n//TODOLATER: translucent blur between keys\n//TODOLATER: Should the keys be black and white?\n\n//TODOLATER: Colour similar commands? Maybe based on the linear menu they would appear in.\n//TODOLATER: levels of commands (chrome etc.)\n\n//TODOLATER: Feedback\n//TODOLATER: add a delay spinner/timer\n//TODOLATER: extract a row component.\n//TODOLATER: find a way to maybe merge the KEYBOARD_LAYOUT onto the hierarchy or vice versa.\n\n//BUG: I have a sneaking suspicion space doesn't work properly.\n\n//TODOLATER: extract a proper function for mapping keyName||label etc into the proper key including shifted key.\n\nexport const Key = ({\n  id,\n  label,\n  keyName,\n  command,\n  submenu,\n  symbol,\n  pressed,\n  type,\n  onClick,\n  color = \"initial\"\n}) => {\n  let hasCommandOrSubmenu = command || submenu;\n  let faded = hasCommandOrSubmenu || pressed ? \"\" : \"faded\";\n  pressed = pressed ? \"pressed\" : \"\";\n  type = type || \"\";\n\n  return (\n    <div\n      //TODOLATER: Should we be binding the name here, or a level up?\n      onClick={e => onClick(keyName || label, e)}\n      className={`button ${faded} ${pressed} ${type}`}\n      id={id || label}\n      style={{\n        backgroundColor: `var(--color-${color})`\n      }}\n    >\n      {!!label && <div className=\"label\"> {label} </div>}\n      {!!command && <div className=\"command\"> {command} </div>}\n      {!!submenu && <div className=\"submenu\"> {submenu} </div>}\n      {!!symbol && <div className=\"symbol\"> {symbol} </div>}\n    </div>\n  );\n};\n\nexport const Row = ({\n  row,\n  commandsAvailable,\n  onKeyClick,\n  modifiersPressed\n}) => {\n  return (\n    <div className=\"row\">\n      {row.map(keyConfig => (\n        <Key\n          key={keyConfig.id || keyConfig.label}\n          onClick={onKeyClick}\n          {...keyConfig}\n          {...commandsAvailable[keyConfig.id || keyConfig.label]}\n          pressed={modifiersPressed[keyConfig.keyName || keyConfig.label]}\n        />\n      ))}\n    </div>\n  );\n};\n\nexport const KeyMapDisplay = ({\n  commandsAvailable = {},\n  layoutName = \"mac\",\n  active = false,\n  modifiersPressed = {},\n  onKeyClick = noop\n}) => {\n  let classes = [\"container\"];\n  if (active) {\n    classes.push(\"active\");\n  }\n\n  let viewportWidth = Math.max(\n    document.documentElement.clientWidth,\n    window.innerWidth || 0\n  );\n  let layout = layouts[layoutName];\n\n  return (\n    <div\n      style={{ transform: `scale(${viewportWidth / 988})` }}\n      className={`keymap containerscontainer ${layoutName || \"mac\"}`}\n    >\n      <div className={classes.join(\" \")}>\n        {layout.map((row, index) => (\n          <Row\n            key={index}\n            row={row}\n            commandsAvailable={commandsAvailable}\n            onKeyClick={onKeyClick}\n            modifiersPressed={modifiersPressed}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\n\nexport class KeyMap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.shortcuts = React.createRef();\n  }\n\n  resize = throttle(() => {\n    this.forceUpdate();\n  }, 300);\n\n  componentDidMount() {\n    window.addEventListener(\"resize\", this.resize);\n    document.addEventListener(\"click\", this.props.onClose);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"resize\", this.resize);\n    document.removeEventListener(\"click\", this.props.onClose);\n  }\n\n  render() {\n    let currentModifiers = Object.keys(this.props.modifiersPressed).filter(\n      m => this.props.modifiersPressed[m]\n    );\n\n    let modifiersPressedString = chordArrayToString(currentModifiers);\n    const currentHierarchy = this.props.path.reduce(\n      (prev, current) => prev[current],\n      this.props.commandHierarchy\n    );\n    let commandsAvailable = currentHierarchy[modifiersPressedString] || {};\n\n    let pathInProgressOrModifierPressed =\n      modifiersPressedString.length + this.props.path.length > 0;\n\n    let active =\n      (pathInProgressOrModifierPressed && this.props.delayTimeOver) ||\n      this.props.demo;\n\n    return (\n      <React.Fragment>\n        <Shortcuts ref={this.shortcuts} {...this.props} />\n        <KeyMapDisplay\n          layoutName={this.props.layoutName}\n          active={active}\n          commandsAvailable={commandsAvailable}\n          onKeyClick={this.handleKeyClick.bind(this)}\n          modifiersPressed={this.props.modifiersPressed}\n        />\n      </React.Fragment>\n    );\n  }\n\n  handleKeyClick(key, e) {\n    e.stopPropagation();\n    e.nativeEvent.stopImmediatePropagation();\n\n    this.shortcuts.current.wrappedInstance.handleKeyboard({\n      type: \"click\",\n      key: key\n    });\n  }\n}\n\nexport default connect(\n  state => {\n    let configuration = getCurrentProps(state.configuration);\n    return { ...state.shortcuts, ...configuration };\n  },\n  {\n    onResetShortcuts: resetShortcuts\n  }\n)(KeyMap);\n","export const openMenu = menu => ({\n  type: OPEN_MENU,\n  menu\n});\nexport const openAllMenus = () => ({\n  type: OPEN_ALL_MENUS\n});\n\nexport const closeAllMenus = () => ({\n  type: CLOSE_ALL_MENUS\n});\nexport const OPEN_MENU = \"OPEN_MENU\";\nexport const OPEN_ALL_MENUS = \"OPEN_ALL_MENUS\";\nexport const CLOSE_ALL_MENUS = \"CLOSE_ALL_MENUS\";\n","import {\n  chordArrayFromString,\n  chordArrayToString,\n  getLetterFromChord,\n  getModifiersFromChord\n} from \"./ShortcutUtils\";\n\n/**\n * Merges two command hierarchies. The right side is merged into the right in place.\n *\n * @param {Object} h1 This is assumed to be in proper working order with sorted modifiers. This object is modified\n * @param {Object} h2 New hierarchy to merge in.\n * @param {*} level Level to add to all commands.\n *\n * @returns {Object} mergedCommandHierarchy\n */\nexport function mergeCommandHierarchy(left, right, level = undefined) {\n  //TODOLATER: Add level information, it might require breaking out a helper.\n\n  for (const key of Object.keys(right)) {\n    let keyFixed = chordArrayToString(chordArrayFromString(key));\n\n    if (keyFixed in left) {\n      if (typeof left[keyFixed] === \"object\") {\n        mergeCommandHierarchy(left[keyFixed], right[key], level);\n      }\n    } else {\n      left[keyFixed] = right[key];\n    }\n  }\n\n  return left;\n}\n\n/**\n * Given a list of linear menus it returns a command hierarchy from traversing the shortcuts.\n *\n * @param {Array} menus\n * @returns {Object} commandHierarchy\n */\nexport function menuToCommandHierarchy(menus) {\n  let commandHierarchy = {};\n\n  menus.forEach(menu => {\n    let others = { ...menu };\n    delete others[\"items\"];\n    menu.items.forEach(({ command, shortcut }) => {\n      let currentHierarchy = commandHierarchy;\n\n      shortcut.forEach((chord, index) => {\n        let modifiers = chordArrayToString(getModifiersFromChord(chord));\n        let letter = getLetterFromChord(chord);\n\n        if (!(modifiers in currentHierarchy)) {\n          currentHierarchy[modifiers] = {};\n        }\n\n        if (!(letter in currentHierarchy[modifiers])) {\n          currentHierarchy[modifiers][letter] = {};\n        }\n\n        if (index === shortcut.length - 1) {\n          currentHierarchy[modifiers][letter] = { command, ...others };\n        }\n\n        currentHierarchy = currentHierarchy[modifiers][letter];\n      });\n    });\n  });\n\n  return commandHierarchy;\n}\n\nexport function navigateToSubmenu(commandHierarchy, shortcut) {\n  let modifiers = getModifiersFromChord(shortcut[0]);\n  let letter = getLetterFromChord(shortcut[0]);\n\n  if (shortcut.length === 1) {\n    return commandHierarchy[modifiers][letter];\n  } else {\n    return navigateToSubmenu(commandHierarchy);\n  }\n}\n\nexport const MACOS_COMMAND_HIERARCHY = {\n  meta: {\n    q: {\n      command: \"quit application\"\n    },\n    space: {\n      command: \"spotlight search\"\n    }\n  }\n};\n\nexport const CHROME_COMMAND_HIERARCHY = {\n  meta: {\n    w: {\n      command: \"close tab\"\n    },\n    t: {\n      command: \"new tab\"\n    },\n    n: {\n      command: \"new window\"\n    },\n    r: {\n      command: \"refresh\"\n    }\n  },\n  \"meta+shift\": {\n    n: {\n      command: \"new incognito window\"\n    },\n    r: {\n      command: \"hard refresh\"\n    }\n  }\n};\n\nexport const GOOGLE_DOCS_COMMAND_HIERARCHY = {\n  meta: {\n    b: {\n      icon: \"bold.png\",\n      command: \"bold\"\n    },\n    i: {\n      command: \"italics\"\n    },\n    u: {\n      command: \"underline\"\n    },\n    \".\": {\n      command: \"superscript\"\n    },\n    \",\": {\n      command: \"subscript\"\n    },\n    space: {\n      command: \"clear formatting\"\n    },\n    backslash: {\n      command: \"clear formatting\"\n    },\n    c: {\n      command: \"copy\"\n    },\n    v: {\n      command: \"paste\"\n    },\n    k: {\n      command: \"insert link\"\n    },\n    f: {\n      command: \"find\"\n    },\n    h: {\n      command: \"find and replace\"\n    }\n    // g: {\n    //   submenu: \"submenu\",\n    //   meta: {\n    //     w: {\n    //       command: \"wait\"\n    //     }\n    //   }\n    // }\n  },\n  alt: {\n    f: {\n      command: \"file menu\"\n    },\n    e: {\n      command: \"edit menu\"\n    },\n    v: {\n      command: \"view menu\"\n    },\n    i: {\n      command: \"insert menu\"\n    },\n    o: {\n      command: \"format menu\"\n    },\n    t: {\n      command: \"tools menu\"\n    },\n    n: {\n      command: \"add-ons menu\"\n    },\n    h: {\n      command: \"help menu\"\n    }\n  },\n  \"meta+shift\": {\n    c: {\n      command: \"count words\"\n    },\n    l: {\n      command: \"left align\"\n    },\n    e: {\n      command: \"center align\"\n    },\n    r: {\n      command: \"right align\"\n    },\n    j: {\n      command: \"justify text\"\n    },\n    \"7\": {\n      command: \"numbered list\"\n    },\n    \"8\": {\n      command: \"bulleted list\"\n    },\n    y: {\n      command: \"define word\"\n    },\n    backslash: {\n      command: \"context menu\"\n    },\n    x: {\n      command: \"context menu\"\n    }\n  },\n  \"alt+shift\": {\n    \"5\": {\n      command: \"strikethrough\"\n    },\n\n    f: {\n      command: \"file menu\"\n    },\n    e: {\n      command: \"edit menu\"\n    },\n    v: {\n      command: \"view menu\"\n    },\n    i: {\n      command: \"insert menu\"\n    },\n    o: {\n      command: \"format menu\"\n    },\n    t: {\n      command: \"tools menu\"\n    },\n    n: {\n      command: \"add-ons menu\"\n    },\n    h: {\n      command: \"help menu\"\n    }\n  },\n  \"alt+meta\": {\n    \"0\": {\n      command: \"normal text\"\n    },\n    \"1\": {\n      command: \"heading 1\"\n    },\n    \"2\": {\n      command: \"heading 2\"\n    },\n    \"3\": {\n      command: \"heading 3\"\n    },\n    \"4\": {\n      command: \"heading 4\"\n    },\n    \"5\": {\n      command: \"heading 5\"\n    },\n    \"6\": {\n      command: \"heading 6\"\n    },\n    k: {\n      command: \"resize larger\"\n    },\n    j: {\n      command: \"resize smaller\"\n    },\n    c: {\n      command: \"copy formatting\"\n    },\n    v: {\n      command: \"paste formatting\"\n    },\n    f: {\n      command: \"insert footnote\"\n    },\n    m: {\n      command: \"add comment\"\n    }\n  },\n  \"alt+meta+shift\": {\n    z: {\n      command: \"switch to editing\"\n    },\n    x: {\n      command: \"switch to suggesting\"\n    },\n    c: {\n      command: \"switch to viewing\"\n    },\n    a: {\n      command: \"open comments thread\"\n    }\n  }\n};\n\nconst hierarchies = {};\n\nmergeCommandHierarchy(hierarchies, GOOGLE_DOCS_COMMAND_HIERARCHY);\nmergeCommandHierarchy(hierarchies, MACOS_COMMAND_HIERARCHY);\nmergeCommandHierarchy(hierarchies, CHROME_COMMAND_HIERARCHY);\n\nexport const all_hierarchies = hierarchies;\n","import React from \"react\";\nimport \"./LinearMenuBar.css\";\nimport { shortcutToPrettyString } from \"../Shortcuts/ShortcutUtils\";\nimport Shortcuts from \"../Shortcuts/Shortcuts\";\nimport { connect } from \"react-redux\";\nimport { getCurrentProps } from \"../../Workflow\";\n\nimport { openAllMenus, openMenu, closeAllMenus } from \"../../actions/menus\";\nimport { menuToCommandHierarchy } from \"../Shortcuts/CommandHierarchies\";\nimport { noop } from \"lodash\";\n\nconst LinearItem = ({ command, shortcut, onClick }) => {\n  return (\n    <div onClick={e => onClick(command, e)} className=\"item\">\n      <span className=\"label\"> {command} </span>\n      {shortcut && (\n        <span className=\"shortcut\">{shortcutToPrettyString(shortcut)}</span>\n      )}\n    </div>\n  );\n};\n\nexport const LinearMenu = ({\n  open,\n  title,\n  items,\n  onItemClick,\n  onMenuClick,\n  onMouseEnter,\n  color = \"mac\"\n}) => {\n  let active = open ? \"active\" : \"\";\n  return (\n    <div\n      className={`linear-menu ${active}`}\n      onMouseEnter={e => onMouseEnter(title, e)}\n      style={{\n        backgroundColor: `var(--color-${color})`\n      }}\n    >\n      <div className=\"title\" onClick={e => onMenuClick(title, e)}>\n        {title}\n      </div>\n\n      <div className=\"menu\">\n        {items.map(menuItem => (\n          <LinearItem\n            key={menuItem.command}\n            onClick={onItemClick}\n            {...menuItem}\n          />\n        ))}\n      </div>\n    </div>\n  );\n};\nexport const LinearMenuBarDisplay = ({\n  allOpen = false,\n  menus,\n  openMenu,\n  onMenuClick = noop,\n  onMouseEnter = noop,\n  onItemClick = noop\n}) => {\n  return (\n    <div className=\"linear-menu-bar\">\n      {menus.map(menu => {\n        let open = allOpen || openMenu === menu.title;\n\n        return (\n          <LinearMenu\n            key={menu.title}\n            onMenuClick={onMenuClick}\n            onMouseEnter={onMouseEnter}\n            onItemClick={onItemClick}\n            {...menu}\n            open={open}\n          />\n        );\n      })}\n    </div>\n  );\n};\n\n// handleTitleClick(e) {\n//   e.nativeEvent.stopImmediatePropagation();\n//   e.stopPropagation();\n//   this.props.onClick();\n// }\n\n// handleItemClick(command, e) {\n//   e.nativeEvent.stopImmediatePropagation();\n//   e.stopPropagation();\n//   this.props.onCommand(command);\n// }\n\nexport class LinearMenuBar extends React.PureComponent {\n  componentWillUnmount() {\n    document.removeEventListener(\"click\", this.props.onCloseAllMenus);\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"click\", this.props.onCloseAllMenus);\n  }\n\n  render() {\n    return (\n      <React.Fragment>\n        <Shortcuts\n          commandHierarchy={menuToCommandHierarchy(this.props.menus)}\n          onCommand={this.props.onCommand}\n          onModifiersChanged={() => {\n            if (Object.values(this.props.modifiersPressed).some(m => !!m)) {\n              this.props.onOpenAllMenus();\n            } else {\n              this.props.onCloseAllMenus();\n            }\n          }}\n        />\n        <LinearMenuBarDisplay\n          allOpen={\n            this.props.delayTimeOver &&\n            this.props.exposeHK &&\n            this.props.allMenusOpen\n          }\n          openMenu={this.props.openMenu}\n          menus={this.props.menus}\n          onMenuClick={this.handleMenuClick}\n          onMouseEnter={this.handleMouseEnter}\n          onItemClick={this.handleItemClick}\n        />\n      </React.Fragment>\n    );\n  }\n\n  handleMenuClick = (menuTitle, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n\n    if (this.props.openMenu === menuTitle) {\n      this.props.onCloseAllMenus();\n    } else {\n      this.props.onOpenMenu(menuTitle);\n    }\n  };\n\n  handleItemClick = (item, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n\n    this.props.onCommand(item, true, \"click\");\n    this.props.onCloseAllMenus();\n  };\n\n  handleMouseEnter = menuTitle => {\n    if (this.props.openMenu) {\n      this.props.onOpenMenu(menuTitle);\n    }\n  };\n}\n\nlet LinearMenuBarConnected = connect(\n  state => {\n    let configuration = getCurrentProps(state.configuration);\n    return { ...state.shortcuts, ...state.menus, ...configuration };\n  },\n  {\n    onCloseAllMenus: closeAllMenus,\n    onOpenAllMenus: openAllMenus,\n    onOpenMenu: openMenu\n  }\n)(LinearMenuBar);\n\nexport class ExposeHK extends React.Component {\n  render() {\n    return <LinearMenuBarConnected {...this.props} exposeHK />;\n  }\n}\n\nexport default LinearMenuBarConnected;\n","export const hideStimulus = () => ({\n  type: HIDE_STIMULUS,\n});\n\nexport const showStimulus = () => ({\n  type: SHOW_STIMULUS,\n})\n\nexport const HIDE_STIMULUS = \"HIDE_STIMULUS\";\nexport const SHOW_STIMULUS = \"SHOW_STIMULUS\";\n","import styled from \"styled-components\";\nimport Paper from \"@material-ui/core/Paper\";\n\nexport const CenteredPaper = styled(Paper)`\n  position: absolute;\n  ${({ axis }) => axis !== \"horizontal\" && `left: 50%`};\n  ${({ axis }) => axis !== \"vertical\" && `top: 50%`};\n  ${({ top }) => `top: ${top}%;`}\n  transform: translate(\n    ${({ axis }) => (axis !== \"horizontal\" ? \"-50%\" : \"0\")},\n    ${({ axis }) => (axis !== \"vertical\" ? \"-50%\" : \"0\")}\n  );\n  width: ${props => props.width || \"800px\"};\n  padding: 20px;\n`;\n\nexport const CenteredText = styled.div`\n  text-align: center;\n`;\n\nexport const centered = `position: absolute;\ntop: 50%;\nleft: 50%;\ntransform: translate(-50%, -50%);`;\n\n// icon: {\n//   fontSize: 20,\n// },\n// iconVariant: {\n//   opacity: 0.9,\n//   marginRight: theme.spacing.unit,\n// },\n\n// // #d32f2f\n","import React, { Component } from \"react\";\n\nimport DropdownMenu from \"../menus/DropdownMenu\";\nimport KeyMap from \"../menus/KeyMap/KeyMap\";\nimport { LinearMenuBar, ExposeHK } from \"../menus/LinearMenuBar/LinearMenuBar\";\nimport Shortcuts from \"../menus/Shortcuts/Shortcuts\";\n\nimport { connect } from \"react-redux\";\nimport { hideStimulus, showStimulus } from \"../actions/tasks\";\nimport { getCurrentProps } from \"../Workflow\";\nimport Button from \"@material-ui/core/Button\";\nimport \"./StimulusResponseTask.css\";\nimport styled from \"styled-components\";\nimport { CenteredPaper } from \"../layout\";\n\n//TODOLATER: if we use a module we can write something like \"import * as menus from \"../menus\".\n// let cache = {};\n\n// function importAll(r) {\n//   r.keys().forEach(key => (cache[key] = r(key)));\n// }\n\n// importAll(require.context(\"../menus/\", true, /^.*\\/(?!.*test).*\\.js$/));\n// At build-time cache will be populated with all required modules.\nconst OuterProgress = styled.div`\n  background-color: rgb(240, 132, 171);\n  width: 100%;\n  overflow: hidden;\n  height: 5px;\n`;\nconst InnerProgress = styled.div`\n  width: ${props => props.value}%;\n  background-color: rgb(225, 0, 80);\n  height: 100%;\n`;\nconst Progress = ({ value }) => (\n  <OuterProgress>\n    <InnerProgress value={value} />\n  </OuterProgress>\n);\n\nconst menus = {\n  LinearMenuBar,\n  DropdownMenu,\n  KeyMap,\n  ExposeHK,\n  Shortcuts\n};\n\nconst stimulusTypes = {\n  ImageStimulus,\n  TextStimulus\n};\n\n//TODOLATER: passing possition is awkward\n\nexport function Stimulus({ children, position, color }) {\n  let style = {};\n\n  if (color) {\n    style.borderColor = `var(--color-${color})`;\n  } else {\n    style.border = \"none\";\n  }\n\n  return (\n    <div style={style} className={`stimulus ${position}`}>\n      {children}\n    </div>\n  );\n}\n\nexport function TextStimulus({ stimulus, position, color }) {\n  return (\n    <Stimulus color={color} position={position}>\n      <p className=\"text-stimulus\">{stimulus}</p>\n    </Stimulus>\n  );\n}\nexport function ImageStimulus({\n  stimulus,\n  stimulusImageExtension,\n  stimulusImagePath,\n  position,\n  color\n}) {\n  return (\n    <Stimulus color={color} position={position}>\n      <img\n        src={`${stimulusImagePath}/${stimulus}.${stimulusImageExtension}`}\n        alt=\"\"\n      />\n    </Stimulus>\n  );\n}\n\nexport class StimulusResponseTask extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      redScreen: false\n    };\n  }\n\n  render() {\n    let Menu = menus[this.props.menu] || DropdownMenu;\n    let StimulusType = stimulusTypes[this.props.stimulusType] || TextStimulus;\n\n    return (\n      <div>\n        <div\n          className={\n            \"screen-flash \" + (this.state.redScreen ? \"screen-flash-red\" : \"\")\n          }\n        />\n\n        {this.props.withNext && (\n          <Button onClick={this.props.onAdvanceWorkflow}>\n            Shortcut won't work\n          </Button>\n        )}\n\n        {this.props.showStimulus ? (\n          <React.Fragment>\n            <StimulusType {...this.props} />\n            <Menu\n              {...this.props}\n              onCommand={this.validateSelection.bind(this)}\n            />\n          </React.Fragment>\n        ) : (\n          <CenteredPaper width=\"inherit\" axis=\"both\">\n            <h1> Incorrect </h1>\n            <Progress\n              value={\n                (100 * (new Date().getTime() - this.state.time)) /\n                this.props.delayOnError\n              }\n            />\n          </CenteredPaper>\n        )}\n      </div>\n    );\n  }\n\n  validateSelection(item, delayOver, clicked) {\n    this.props.onLog(\n      \"correct\",\n      JSON.stringify(item) === JSON.stringify(this.props.stimulus),\n      false\n    );\n\n    this.props.onLog(\"delayIsOver\", delayOver, false);\n    this.props.onLog(\"clicked\", clicked, false);\n\n    if (!this.props.showStimulus) {\n      // If the stimulus is hidden, don't do anything\n      return;\n    } else if (JSON.stringify(item) === JSON.stringify(this.props.stimulus)) {\n      // Always advance if they're correct\n      this.props.onAdvanceWorkflow();\n    } else {\n      // They made a mistake\n      if (this.props.flashOnError) {\n        this.setState({ redScreen: false, time: new Date().getTime() }, () => {\n          this.setState({ redScreen: true });\n        });\n      }\n\n      if (this.props.continueOnError) {\n        if (this.props.delayOnError) {\n          // If we're timing out on errors, hide the stimulus and wait a while\n          this.props.onHideStimulus();\n          setTimeout(this.onErrorTimeout.bind(this), this.props.delayOnError);\n          this.interval = setInterval(this.forceUpdate.bind(this), 20);\n        } else {\n          // Otherwise, move on immediately\n          this.props.onAdvanceWorkflow();\n        }\n      }\n    }\n  }\n\n  onErrorTimeout() {\n    this.props.onShowStimulus();\n    this.props.onAdvanceWorkflow();\n    clearInterval(this.interval);\n  }\n  componentDidMount() {\n    this.props.onShowStimulus();\n  }\n}\n\nconst ConnectedStimulusResponseTask = connect(\n  state => {\n    let configuration = getCurrentProps(state.configuration);\n    return { ...state.tasks, ...configuration };\n  },\n  {\n    onHideStimulus: hideStimulus,\n    onShowStimulus: showStimulus\n  }\n)(StimulusResponseTask);\n\nexport default ConnectedStimulusResponseTask;\n","import React, { Component } from \"react\";\nimport styled from \"styled-components\";\nimport { centered } from \"../layout\";\n\nconst Content = styled.span`\n  display: table-cell;\n  vertical-align: middle;\n`;\n\nconst MouseCenterer = styled.div`\n  width: 70px;\n  height: 70px;\n  white-space: normal;\n  border-width: 3px;\n  border-style: solid;\n  padding: 4px;\n  text-align: center;\n  font-size: 12px;\n  cursor: default;\n  font-weight: bold;\n  display: table;\n  ${centered};\n`;\n\nexport default class MouseCenteringTask extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      mouseOver: false\n    };\n    this.buttonRef = React.createRef();\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keydown\", this.handleKey, false);\n    const box = this.buttonRef.current.getBoundingClientRect();\n\n    if (\n      window.mousex > box.left &&\n      window.mousex < box.right &&\n      window.mousey > box.top &&\n      window.mousey < box.bottom\n    ) {\n      this.setState({ mouseOver: true });\n    }\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keydown\", this.handleKey, false);\n  }\n\n  render() {\n    let content = this.state.mouseOver ? \"Press the spacebar\" : \"Mouse here\";\n    return (\n      <MouseCenterer\n        innerRef={this.buttonRef}\n        onMouseOver={() => {\n          this.setState({ mouseOver: true });\n        }}\n        onMouseOut={() => {\n          this.setState({ mouseOver: false });\n        }}\n      >\n        <Content>{content}</Content>\n      </MouseCenterer>\n    );\n  }\n\n  handleKey = e => {\n    if (e.key === \" \" && this.state.mouseOver) {\n      this.props.onAdvanceWorkflow();\n    }\n  };\n\n  handleClick = e => {\n    this.setState({ hasClicked: true });\n  };\n}\n","import React, { Component } from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport \"./DisplayTextTask.css\";\n\nexport default class DisplayTextTask extends Component {\n  render() {\n    return (\n      <div className=\"display-task-container centered\">\n        <h1>{this.props.displayedText}</h1>\n        <Button\n          variant=\"contained\"\n          color=\"primary\"\n          onClick={() => this.props.onAdvanceWorkflow()}\n        >\n          Continue\n        </Button>\n      </div>\n    );\n  }\n}\n","export const advanceWorkflow = () => {\n  return {\n    type: ADVANCE_WORKFLOW\n  };\n};\n\nexport const advanceWorkflowLevelTo = (level, newValue) => {\n  return {\n    type: ADVANCE_WORKFLOW_LEVEL_TO,\n    level,\n    newValue\n  };\n};\n\nexport const log = (key, value) => {\n  return {\n    type: LOG,\n    key,\n    value\n  };\n};\n\nexport const logAction = (action, withTimeStamp = true) => {\n  return {\n    type: LOG_ACTION,\n    action,\n    withTimeStamp\n  };\n};\n\nexport const editConfig = (key, value) => {\n  return {\n    type: EDIT_CONFIG,\n    key,\n    value\n  };\n};\n\nexport const ADVANCE_WORKFLOW = \"ADVANCE_WORKFLOW\";\nexport const ADVANCE_WORKFLOW_LEVEL_TO = \"ADVANCE_WORKFLOW_LEVEL_TO\";\nexport const LOG = \"LOG\";\nexport const LOG_ACTION = \"LOG_ACTION\";\nexport const EDIT_CONFIG = \"EDIT_CONFIG\";\n","import React from \"react\";\nimport AWS from \"aws-sdk\";\nimport Typography from \"@material-ui/core/Typography\";\n\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport Button from \"@material-ui/core/Button\";\n\nimport { log } from \"../actions/\";\nimport { connect } from \"react-redux\";\nimport { CenteredPaper, CenteredText } from \"../layout\";\n\n//TODOLATER: properly this should be one component for error another for spinner\n\n//TODO: sometimes this updates things while unmounted which is actually just suspicious af.\n\nexport const UploadToS3Display = ({\n  error,\n  participant,\n  log,\n  experimenter,\n  onClick\n}) => {\n  let contents;\n\n  if (!error) {\n    contents = (\n      <div>\n        <Typography>We're uploading your results!</Typography>\n        <br />\n        <CircularProgress size={100} />\n      </div>\n    );\n  } else {\n    contents = (\n      <div>\n        <p>\n          Something went wrong uploading your results. We'll still compensate\n          you for your time upon submitting the hit. Please download the results\n          and send them to <a href={`mailto:${experimenter}`}>{experimenter}</a>\n        </p>\n        <a\n          download={`${participant}.json`}\n          href={`data:text/json;charset=utf-8,${log}`}\n        >\n          Download experiment log\n        </a>\n        <br />\n        <Button variant=\"contained\" color=\"primary\" onClick={onClick}>\n          Continue\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <CenteredPaper axis=\"both\" width=\"inherit\">\n      <CenteredText>{contents}</CenteredText>\n    </CenteredPaper>\n  );\n};\n\nclass UploadToS3 extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {};\n\n    AWS.config.region = this.props.AWS_REGION;\n    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n      IdentityPoolId: this.props.AWS_COGNITO_IDENTITY_POOL_ID\n    });\n\n    this.s3 = new AWS.S3({\n      apiVersion: \"2006-03-01\",\n      params: { Bucket: this.props.AWS_S3_BUCKET }\n    });\n  }\n\n  UNSAFE_componentWillMount() {\n    if (this.props.fireAndForget) {\n      this.attemptUploadWithRetries(1);\n      this.props.onAdvanceWorkflow();\n    } else {\n      this.attemptUploadWithRetries(3);\n    }\n  }\n\n  attemptUploadWithRetries(retries) {\n    let logs = { ...this.props.log };\n    logs.events = window.logs;\n\n    this.uploadJSONFile(this.props.s3FileName, logs)\n      .then(() => {\n        if (!this.props.fireAndForget) {\n          this.props.onAdvanceWorkflow();\n          this.setState({ done: true });\n        }\n      })\n      .catch(err => {\n        this.props.onLog(\"s3 error\", err);\n\n        if (retries > 0) {\n          this.attemptUploadWithRetries(retries - 1);\n        } else {\n          this.setState({ error: true });\n        }\n      });\n  }\n\n  //https://blog.mturk.com/tutorial-how-to-create-hits-that-ask-workers-to-upload-files-using-amazon-cognito-and-amazon-s3-38acb1108633\n  uploadJSONFile(fileName, data) {\n    return new Promise((resolve, reject) => {\n      this.s3.upload(\n        {\n          Key: fileName,\n          Body: JSON.stringify(data),\n          ContentType: \"json\",\n          ACL: \"bucket-owner-full-control\"\n        },\n        (err, data) => {\n          if (err) {\n            reject(err, data);\n          } else {\n            resolve(data);\n          }\n        }\n      );\n    });\n  }\n\n  render() {\n    if (this.state.done) {\n      return null;\n    }\n    return (\n      <UploadToS3Display\n        log={JSON.stringify(this.props.log)}\n        participant={this.props.log.participant}\n        onClick={this.props.onAdvanceWorkflow}\n        experimenter={this.props.experimenter}\n        error={this.state.error}\n      />\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    log: state.configuration\n  };\n};\nconst mapDispatchToProps = {\n  onLog: log\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadToS3);\n","import React from \"react\";\n\nexport default class extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  handleLoad = e => {\n    if (this.state.hasLoaded) {\n      this.props.onAdvanceWorkflow();\n    } else {\n      this.setState({ hasLoaded: true });\n    }\n  };\n\n  render() {\n    let { prefillParticipant, formId, participant } = this.props;\n\n    let src = `https://docs.google.com/forms/d/e/${formId}/viewform?embedded=true`;\n\n    if (prefillParticipant) {\n      src = `${src}&${prefillParticipant}=${participant}`;\n    }\n\n    return (\n      <iframe\n        style={{\n          width: \"100%\",\n          height: \"100vh\"\n        }}\n        ref=\"iframe\"\n        title=\"Questionnaire\"\n        src={src}\n        frameBorder=\"0\"\n        marginHeight=\"0\"\n        marginWidth=\"0\"\n        onLoad={this.handleLoad}\n      >\n        Loading...\n      </iframe>\n    );\n  }\n}\n\n//entry.812855120\n","/**\n * Shuffles array in place. ES6 version\n * @param {Array} a An array containing the items.\n */\nexport function shuffle(a) {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [a[i], a[j]] = [a[j], a[i]];\n  }\n  return a;\n}\n\n/**\n * Returns a random choice from the array.\n * @param {Array} a An array containing the options.\n */\nexport function randomChoice(a) {\n  return a[Math.floor(Math.random() * a.length)];\n}\n\n/**\n * Returns a random choice from the array.\n * @param {Array} a An array containing the options.\n */\nexport function randomChoiceNoReplacement(a) {\n  const index = [Math.floor(Math.random() * a.length)];\n  const choice = a[index];\n  a.splice(index, 1);\n\n  return choice;\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function randInt(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive\n}\n\n/**\n * Generates a random GUID.\n */\nexport function uuidv4() {\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n    var r = (Math.random() * 16) | 0,\n      v = c === \"x\" ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n * Generates a random string.\n */\nexport function randomString() {\n  return Math.random().toString(36).substring(2);\n}\n\n// Return array of string values, or NULL if CSV string not well formed.\n//https://stackoverflow.com/a/8497474/1036813\nexport function CSVtoArray(text) {\n  var re_valid = /^\\s*(?:'[^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*'|\"[^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*\"|[^,'\"\\s\\\\]*(?:\\s+[^,'\"\\s\\\\]+)*)\\s*(?:,\\s*(?:'[^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*'|\"[^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*\"|[^,'\"\\s\\\\]*(?:\\s+[^,'\"\\s\\\\]+)*)\\s*)*$/;\n  var re_value = /(?!\\s*$)\\s*(?:'([^'\\\\]*(?:\\\\[\\S\\s][^'\\\\]*)*)'|\"([^\"\\\\]*(?:\\\\[\\S\\s][^\"\\\\]*)*)\"|([^,'\"\\s\\\\]*(?:\\s+[^,'\"\\s\\\\]+)*))\\s*(?:,|$)/g;\n  // Return NULL if input string is not well formed CSV string.\n  if (!re_valid.test(text)) return null;\n  var a = []; // Initialize array to receive values.\n  text.replace(\n    re_value, // \"Walk\" the string using replace with callback.\n    function (m0, m1, m2, m3) {\n      // Remove backslash from \\' in single quoted values.\n      if (m1 !== undefined) a.push(m1.replace(/\\\\'/g, \"'\"));\n      // Remove backslash from \\\" in double quoted values.\n      else if (m2 !== undefined) a.push(m2.replace(/\\\\\"/g, '\"'));\n      else if (m3 !== undefined) a.push(m3);\n      return \"\"; // Return empty string.\n    }\n  );\n  // Handle special case of empty last value.\n  if (/,\\s*$/.test(text)) a.push(\"\");\n  return a;\n}\n\nexport function getOS() {\n  const oss = {\n    Win: \"Windows\",\n    Mac: \"MacOS\",\n    X11: \"UNIX\",\n    Linux: \"Linux\",\n  };\n\n  for (const os of Object.keys(oss)) {\n    if (navigator.appVersion.indexOf(os) >= 0) {\n      return oss[os];\n    }\n  }\n\n  return \"Unknown\";\n}\n\nexport function getBrowserInfo() {\n  return {\n    browserName: navigator.appName,\n    browserEngine: navigator.product,\n    browserVersion1a: navigator.appVersion,\n    browserVersion1b: navigator.userAgent,\n    browserLanguage: navigator.language,\n    browserOnline: navigator.onLine,\n    browserPlatform: navigator.platform,\n    sizeScreenW: window.screen.width,\n    sizeScreenH: window.screen.height,\n    sizeDocW: document.width,\n    sizeDocH: document.height,\n    sizeInW: window.innerWidth,\n    sizeInH: window.innerHeight,\n    sizeAvailW: window.screen.availWidth,\n    sizeAvailH: window.screen.availHeight,\n    scrColorDepth: window.screen.colorDepth,\n    scrPixelDepth: window.screen.pixelDepth,\n  };\n}\n","// --color-light-red: rgb(223, 186, 177);\n// --color-dark-red: rgb(238, 205, 205);\n// --color-orange: rgb(248, 230, 208);\n// --color-yellow: rgb(253, 242, 208);\n// --color-green: rgb(220, 233, 213);\n// --color-turqoise: rgb(211, 223, 226);\n// --color-light-blue: rgb(204, 218, 245);\n// --color-dark-blue: rgb(210, 226, 241);\n// --color-purple: rgb(216, 210, 231);\n// --color-magenta: rgb(230, 210, 219);\n// --color-mac: rgb(249, 249, 249);\n// --color-mac-border: rgb(197, 197, 197);\n\nexport const newMenus = [\n  {\n    title: \"animals\",\n    color: \"dark-red\",\n    items: [\n      { command: \"bat\" },\n      { command: \"camel\" },\n      { command: \"cat\" },\n      { command: \"dinosaur\" },\n      { command: \"dog\" },\n      { command: \"dolphin\" },\n      { command: \"duck\" },\n      { command: \"fish\" },\n      { command: \"frog\" },\n      { command: \"penguin\" },\n      { command: \"pigeon\" },\n      { command: \"zebra\" }\n    ]\n  },\n\n  {\n    title: \"fruits\",\n    color: \"yellow\",\n    items: [\n      { command: \"apple\" },\n      { command: \"banana\" },\n      { command: \"cherry\" },\n      { command: \"grapes\" },\n      { command: \"kiwi\" },\n      { command: \"lemon\" },\n      { command: \"peach\" },\n      { command: \"pear\" },\n      { command: \"pineapple\" },\n      { command: \"orange\" },\n      { command: \"strawberry\" },\n      { command: \"watermelon\" }\n    ]\n  },\n\n  {\n    title: \"office\",\n    color: \"turqoise\",\n    items: [\n      { command: \"chair\" },\n      { command: \"clock\" },\n      { command: \"desk\" },\n      { command: \"keyboard\" },\n      { command: \"mouse\" },\n      { command: \"paperclip\" },\n      { command: \"pencil\" },\n      { command: \"printer\" },\n      { command: \"computer\" },\n      { command: \"calculator\" },\n      { command: \"stapler\" },\n      { command: \"recycling\" }\n    ]\n  },\n\n  {\n    title: \"clothing\",\n    color: \"purple\",\n    items: [\n      { command: \"boot\" },\n      { command: \"bowtie\" },\n      { command: \"gloves\" },\n      { command: \"hat\" },\n      { command: \"belt\" },\n      { command: \"socks\" },\n      { command: \"sweater\" },\n      { command: \"shirt\" },\n      { command: \"pants\" },\n      { command: \"scarf\" },\n      { command: \"bikini\" },\n      { command: \"jacket\" }\n\n      // { command: \"ring\" },\n      // { command: \"watch\" },\n      // { command: \"glasses\" }\n    ]\n  },\n\n  {\n    title: \"recreation\",\n    color: \"dark-blue\",\n\n    items: [\n      { command: \"baseball\" },\n      { command: \"basketball\" },\n      { command: \"bowling\" },\n      { command: \"cards\" },\n      { command: \"darts\" },\n      { command: \"dice\" },\n      { command: \"hockey\" },\n      { command: \"karate\" },\n      { command: \"pool\" },\n      { command: \"puzzle\" },\n      { command: \"racket\" },\n      { command: \"golf\" }\n    ]\n  }\n];\n\nexport const vegetables = [\n  {\n    title: \"vegetables\",\n    items: [\n      { command: \"broccoli\", shortcut: [[\"shift\", \"b\"]] },\n      { command: \"carrot\", shortcut: [[\"shift\", \"c\"]] },\n      { command: \"corn\", shortcut: [[\"shift\", \"o\"]] },\n      { command: \"cucumber\", shortcut: [[\"shift\", \"u\"]] },\n      { command: \"garlic\", shortcut: [[\"shift\", \"g\"]] },\n      { command: \"lettuce\", shortcut: [[\"shift\", \"l\"]] },\n      { command: \"mushroom\", shortcut: [[\"shift\", \"m\"]] },\n      { command: \"onion\", shortcut: [[\"shift\", \"n\"]] },\n      { command: \"pepper\", shortcut: [[\"shift\", \"p\"]] },\n      { command: \"potato\", shortcut: [[\"shift\", \"t\"]] },\n      { command: \"pumpkin\", shortcut: [[\"shift\", \"k\"]] }\n    ]\n  }\n];\n","import React from \"react\";\nimport seedrandom from \"seedrandom\";\n\nimport { menuToCommandHierarchy } from \"../menus/Shortcuts/CommandHierarchies\";\nimport {\n  shuffle,\n  randomChoice,\n  randomString,\n  getBrowserInfo,\n  randomChoiceNoReplacement,\n} from \"../Utils\";\nimport {\n  zip,\n  max,\n  flatten,\n  difference,\n  cloneDeep,\n  map,\n  mapValues,\n  flatMap,\n  remove,\n} from \"lodash\";\nimport { newMenus, vegetables } from \"../data/newStimuli\";\n\n/* eslint import/no-webpack-loader-syntax: off */\nimport ExiiConsentLetter from \"!raw-loader!../data/ExiiConsentLetter.md\";\n\nfunction trialsWithDistribution(frequencies, stimuli) {\n  let result = flatten(\n    frequencies.map((frequency, rank) =>\n      Array(frequency).fill({\n        stimulus: stimuli[rank],\n        rank,\n        frequency,\n      })\n    )\n  );\n  return result;\n}\n\nexport function itemsFromMenu(menu) {\n  return flatMap(menu, (menu) => menu.items.map((item) => item));\n}\n\nfunction stimuliFromMenu(menu) {\n  return itemsFromMenu(menu).map(({ command: stimulus }) => ({ stimulus }));\n}\n\n/**\n * Takes a list of tasks and creates a new level with them occurring after one another.\n * Objects are automatically duplicated if given.\n * @param {String} level Level to label the next piece of config\n * @param {Array|Object} tasks either an array of tasks or an object to duplicate\n */\nfunction compoundTask(level, ...tasks) {\n  let biggest = max(tasks.map((task) => task.length));\n\n  tasks = tasks.map((task) =>\n    Array.isArray(task) ? task : Array(biggest).fill(task)\n  );\n\n  let result = zip(...tasks).map((taskInstances) => ({\n    nextLevel: level,\n    children: taskInstances,\n  }));\n\n  return result;\n}\n\n//TODOLATER: Add a version number with minor and major and maybe major name to let things be better. Then you can t4rack which runs\n//TODOLATER: URL params should overwrite config values\n//TODOLATER: log things like page refreshes.\n\n//TODOLATER: configs are suuuper volatiile because of the random aspect, if you change the order of anything it wrecks everything.\n//TODOLATER: Maybe we reseed the random all the time to fix that?\n\nexport function generateRandomParticipant() {\n  //TODOLATER: cleanup\n  let params = new URL(window.location.href).searchParams;\n  let session = params.get(\"SESSION\") || \"main\";\n  let participant = params.get(\"WORKER_ID\") || \"blaine\";\n  let worker_id = params.get(\"WORKER_ID\") || \"\";\n  let assignment_id = params.get(\"ASSIGNMENT_ID\") || \"\";\n  let hit_id = params.get(\"HIT_ID\") || \"blaine\";\n\n  let s3FileName = `${[participant, session].filter((a) => a).join(\"_\")}.json`;\n\n  let seed = participant;\n  seedrandom(participant, { global: true });\n\n  let menu = randomChoice([\"KeyMap\", \"ExposeHK\"]);\n  let menus = cloneDeep(newMenus);\n\n  let backmap = {\n    animals: \"12qwaszx\",\n    fruits: \"34erdfcv\",\n    office: \"56tyghbn\",\n    clothing: \"78uijkm,\",\n    recreation: \"90opl;./\",\n  };\n\n  backmap = mapValues(backmap, (letters) => letters.split(\"\"));\n\n  // Choose a subset of items, then assign them to the shortcuts in that row.\n  menus.forEach((menu) => {\n    let { items, title } = menu;\n    let letters = shuffle(backmap[title]);\n    letters.pop();\n\n    menu.items = shuffle(items).slice(0, letters.length);\n\n    zip(menu.items, letters).forEach(([item, letter]) => {\n      item.shortcut = [[\"shift\", letter]];\n    });\n  });\n\n  let truncatedZipfian = [8, 4, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1];\n  let selectionBlocks = 6;\n\n  // When choosing shortcuts we chose a subset, so we have to remove those from left, center and right.\n  let allKeys = flatMap(backmap, (value) => value);\n  let inBackMap = (letter) => allKeys.indexOf(letter) !== -1;\n\n  let left = \"123qweasdzxc\".split(\"\").filter(inBackMap);\n  let center = \"456rtyfghvbn\".split(\"\").filter(inBackMap);\n  let right = \"7890uiopjkl;m,./\".split(\"\").filter(inBackMap);\n\n  let z1 = randomChoice(left);\n  let z2 = randomChoice(right);\n  let z3 = randomChoice(center);\n\n  let top3 = [z1, z2, z3];\n\n  // Remove items we've already selected\n  backmap = map(backmap, (keys) =>\n    remove(keys, (value) => top3.indexOf(value) === -1)\n  );\n\n  // Now, select 2 items from every category making sure we haven't selected twice.\n  let categories = flatMap(backmap, (items) => [\n    randomChoiceNoReplacement(items),\n    randomChoiceNoReplacement(items),\n  ]);\n\n  let stimuliShortcuts = [\n    ...top3,\n    ...categories,\n    // ...categories.slice(0, categories.length - 1)\n  ];\n\n  let commandHierarchy = menuToCommandHierarchy(menus);\n\n  let stimuliCommands = stimuliShortcuts.map(\n    (letter) => commandHierarchy.shift[letter].command\n  );\n\n  let recallStim = shuffle(\n    flatten(\n      truncatedZipfian.map((frequency, rank) => ({\n        stimulus: stimuliCommands[rank],\n        rank,\n        frequency,\n        wasAsked: true,\n      }))\n    )\n  );\n\n  let confirmationCode = randomString();\n\n  const extraCommands = menus.map((menu) =>\n    randomChoice(difference(map(menu.items, \"command\"), stimuliCommands))\n  );\n\n  let keyMapTutorial = [\n    { task: \"KeyMapPointerTutorial\" },\n    { task: \"KeyMapGuidedTutorial\" },\n    { task: \"KeyMapShortcutTutorial\" },\n  ];\n  let exposeHKTutorial = [\n    { task: \"ExposeHKPointerTutorial\" },\n    { task: \"ExposeHKGuidedTutorial\" },\n    { task: \"ExposeHKShortcutTutorial\" },\n  ];\n  let tutorial = {\n    label: \"Tutorial\",\n    nextLevel: \"blocks\",\n    menus: vegetables,\n    commandHierarchy: menuToCommandHierarchy(vegetables),\n    fullProgress: false,\n    currentProgress: true,\n    progressLevel: true,\n    children: [\n      ...(menu === \"KeyMap\" ? keyMapTutorial : exposeHKTutorial),\n      {\n        task: \"DisplayTextTask\",\n        displayedText:\n          \"In the real experiment you will first center your mouse in a box and then press space. Afterwards an item for selection will be prompted and you must select it.\",\n      },\n      ...Array(3)\n        .fill({})\n        .map(() => ({\n          nextLevel: \"trial\",\n          children: compoundTask(\n            \"task\",\n            { task: \"MouseCenteringTask\" },\n            {\n              task: \"StimulusResponseTask\",\n              stimulus: \"carrot\",\n            }\n          ),\n        })),\n      {\n        stimulusType: \"TextStimulus\",\n        task: \"StimulusResponseTask\",\n        stimulus:\n          \"Upon making an error there is a 3 second delay. Press Shift + F to see this.\",\n      },\n    ],\n  };\n\n  const recallTask = {\n    label: \"Recall\",\n    task: \"StimulusResponseTask\",\n    menu: \"Shortcuts\",\n    flashOnError: false,\n    delayOnError: 0,\n    nextLevel: \"trial\",\n    fullProgress: false,\n    currentProgress: true,\n    progressLevel: true,\n    children: [\n      {\n        task: \"DisplayTextTask\",\n        displayedText:\n          \"The visible parts of the interface are disabled. You must attempt to use a keyboard shortcut for every item. These are items you have already seen. Take your time and try to get as many correct as possible.\",\n      },\n      ...recallStim,\n      {\n        task: \"DisplayTextTask\",\n        displayedText:\n          \"These next items are items you haven't already selected.\",\n      },\n      ...extraCommands.map((stimulus) => ({\n        stimulus,\n        wasAsked: false,\n      })),\n    ],\n  };\n\n  let selectionTasks = trialsWithDistribution(\n    truncatedZipfian,\n    stimuliCommands\n  );\n\n  selectionTasks.forEach((task) => {\n    for (const menu of menus) {\n      for (const item of menu.items) {\n        if (item.command === task.stimulus) {\n          task.color = menu.color;\n          return;\n        }\n      }\n    }\n  });\n\n  let stimulusType = \"ImageStimulus\";\n  let stimulusImageExtension = \"png\";\n  let stimulusImagePath = \"images\";\n\n  // itemsFromMenu(menus).forEach(({ command: stimulus }) => {\n  //   let img = new Image();\n  //   img.src = `${stimulusImagePath}/${stimulus}.${stimulusImageExtension}`;\n  // });\n\n  let configuration = {\n    condition: menu,\n    confirmationCode,\n    mturk: {\n      hit_id,\n      worker_id,\n      assignment_id,\n    },\n    browser: getBrowserInfo(),\n\n    seed,\n    menus,\n    session,\n    group: \"keymap\",\n    name: \"tutorial_fixed\",\n    experimenter: \"blaine.lewis@uwaterloo.ca\",\n    params: params.toString(),\n    width: Math.max(\n      document.documentElement.clientWidth,\n      window.innerWidth || 0\n    ),\n    height: Math.max(\n      document.documentElement.clientHeight,\n      window.innerHeight || 0\n    ),\n    commandHierarchy,\n    participant,\n    os: \"Windows\",\n\n    menu,\n    delay: 500,\n\n    stimulusType,\n    stimulusImagePath,\n    stimulusImageExtension,\n\n    continueOnError: true,\n    position: menu === \"KeyMap\" ? \"top\" : \"bottom\",\n\n    flashOnError: true,\n    delayOnError: 3000,\n\n    nextLevel: \"section\",\n    children: [\n      // {\n      //   label: \"Stimulus Test\",\n      //   task: \"StimulusResponseTask\",\n      //   continueOnError: true,\n      //   delayOnError: 0,\n      //   flashOnError: false,\n      //   nextLevel: \"trial\",\n      //   children: stimuliFromMenu(newMenus)\n      // },\n      {\n        label: \"Consent\",\n        task: \"ConsentForm\",\n        letter: ExiiConsentLetter,\n        questions: [\n          {\n            label: \"I agree of my own free will to participate in the study.\",\n            required: true,\n          },\n        ],\n      },\n\n      {\n        label: \"Pre-Questionnaire\",\n        task: \"GoogleFormQuestionnaire\",\n        formId: \"1FAIpQLScYw8Rd-j9YPeVN2fAuqQa_TpdF2a0h9fn_6wA7A3prHoGIwQ\",\n        prefillParticipant: \"entry.812855120\",\n      },\n      {\n        label: \"Keyboard Selection\",\n        task: \"KeyboardChooser\",\n      },\n\n      tutorial,\n\n      {\n        label: \"Main Experiment Information\",\n        noProgress: true,\n        withContinue: true,\n        task: \"InformationScreen\",\n        content: `\n# Main Experiment\n\nThe main experiment is about to begin. This is the longest part of the experiment.\n\nIn this task you will perform tasks just like in the tutorial. Select items as quickly and accurately as possible.\n\nShortcuts will use only the **shift** key.\n      `,\n      },\n      {\n        label: \"Selection\",\n        task: \"StimulusResponseTask\",\n        nextLevel: \"block\",\n        fullProgress: false,\n        currentProgress: true,\n        progressLevel: true,\n        children: addBetweenArray(\n          Array(selectionBlocks)\n            .fill({})\n            .map(() => ({\n              nextLevel: \"trial\",\n              children: compoundTask(\n                \"task\",\n                { task: \"MouseCenteringTask\" },\n                shuffle(selectionTasks)\n              ),\n            })),\n          [\n            {\n              task: \"DisplayTextTask\",\n              displayedText:\n                \"The next block of selections is about to begin, take a break if you need to.\",\n            },\n          ],\n          false\n        ),\n      },\n\n      recallTask,\n\n      {\n        label: \"Post-Questionnaire\",\n        task: \"GoogleFormQuestionnaire\",\n        formId: \"1FAIpQLSdZuipxOUtCz-3enkgqxaHtaF_vixCVIzpxS84FfW60AYZgOQ\",\n        prefillParticipant: \"entry.1922125170\",\n      },\n\n      {\n        label: \"Confirmation Code\",\n        task: \"InformationScreen\",\n        withContinue: true,\n\n        content: `\n# Thank you!\n\n## Confirmation Code: **${confirmationCode}**\n\nEnter this code into the HIT and we'll accept it as soon as we can.\n\n## Follow-Up Study\n\nIn 24 hours, we will send you a message on Mechanical Turk asking you to return for an **additional, optional task.** This follow-up task should take under 5 minutes of work. If you complete it, we will pay you **a bonus of $1.00**.\n\n## Contact Information\n\nWe really appreciate your participation. It's vital for real people to test our interfaces and we understand sometimes our experiments can be a bit mind numbing but we really do appreciate your time. \n\nIf the HIT took longer than we suggested it would, feel free to email me at blaine.lewis@uwaterloo.ca and I'll bonus you for time spent after crosschecking with our logs.`,\n      },\n    ],\n  };\n\n  if (session === \"RECALL\") {\n    recallTask.label = \"Followup Recall\";\n    configuration.children = [\n      {\n        label: \"Welcome\",\n        task: \"InformationScreen\",\n        withContinue: true,\n        content: `\n# Followup Study\n\nThis study uses the exact same items and shortcuts as yesterday.\n\nYou won't be able to see the shortcuts or interface and must recall them from memory.`,\n      },\n      recallTask,\n      {\n        label: \"Followup Questionnaire\",\n        task: \"GoogleFormQuestionnaire\",\n        formId: \"1FAIpQLScPsytXjsW9Wa5xElD4LBlO9YgW5g4dLoJc5xdogIx1UFL0SA\",\n        prefillParticipant: \"entry.1922125170\",\n      },\n      {\n        label: \"Thank you!\",\n        withContinue: true,\n        task: \"InformationScreen\",\n        content: `\n# Thank you!\n\nYou'll receive a $1.00 bonus sometime in the next couple of days.\n\nThank you for participating in our experiment and returning for the followup!`,\n      },\n    ];\n  }\n\n  return configuration;\n}\n\n// const configuration = addBetween(\n//   [\"block\"],\n//   generateRandomParticipant(),\n//   {\n//     label: \"Upload\",\n//     task: \"UploadToS3\",\n//     noProgress: true,\n//     fireAndForget: true\n//   },\n//   false\n// );\n\nconst configuration = generateRandomParticipant();\n\nexport const GenerateConfiguration = () => {\n  let config = configuration;\n  let config_string = JSON.stringify(config, null, 2);\n\n  return (\n    <div>\n      <a\n        download={\"config.json\"}\n        href={`data:text/json;charset=utf-8,${config_string}`}\n      >\n        Download\n      </a>\n      <div style={{ fontFamily: \"monospace\", whiteSpace: \"pre\" }}>\n        {config_string}\n      </div>\n    </div>\n  );\n};\n\nfunction addBetween(levels, config, task, end = true) {\n  if (!config.children) {\n    return config;\n  } else if (levels.indexOf(config.nextLevel) > -1) {\n    config.children = addBetweenArray(config.children, task, end);\n  }\n\n  //recurse recurse\n  config.children.forEach((child) => addBetween(levels, child, task, end));\n  return config;\n}\n//TODOLATER: could probably use flatmapdeep to avoid first if statement.\nfunction addBetweenArray(arr, elem, end = true) {\n  return flatMap(arr, (child, index, children) => {\n    let added;\n    if (Array.isArray(elem)) {\n      added = [child, ...elem];\n    } else {\n      added = [child, elem];\n    }\n    if (end || children.length - 1 !== index) {\n      return added;\n    } else {\n      return child;\n    }\n  });\n}\n\n// export const flatConfigurations = flattenToLevel(\n//   generateConfiguration(),\n//   \"participants\"\n// );\nexport { configuration };\n// export const configuration = flatConfigurations.filter(\n//   config => config.participantId === \"KeyMap0\"\n// )[0];\n","import React from \"react\";\nimport marked from \"marked\";\nimport Button from \"@material-ui/core/Button\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport Typography from \"@material-ui/core/Typography\";\n\nimport FormGroup from \"@material-ui/core/FormGroup\";\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\nimport FormControl from \"@material-ui/core/FormControl\";\n\nimport { CenteredPaper } from \"../layout\";\nimport { itemsFromMenu } from \"../design/GenerateConfiguration\";\n\n//TODOLATER: needs stars beside required consents.\n\nexport default class ConsentForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n  handleChange = (name) => (event) => {\n    this.setState({ [name]: event.target.checked });\n  };\n\n  requiredFieldNotFilled() {\n    let requiredNotFilled = this.props.questions.map((question) =>\n      question.required ? !this.state[question.label] : true\n    );\n\n    return !requiredNotFilled.some((val) => !val);\n  }\n\n  handleSubmit = () => {\n    if (!this.requiredFieldNotFilled()) {\n      this.props.onAdvanceWorkflow();\n    }\n  };\n\n  render() {\n    let { letter, questions } = this.props;\n    let error = this.requiredFieldNotFilled();\n    let items = itemsFromMenu(this.props.menus);\n    //   let img = new Image();\n    //   img.src = ``;\n    return (\n      <CenteredPaper axis=\"vertical\">\n        <div style={{ display: \"none\" }}>\n          {items.map(({ command: stimulus }) => (\n            <img\n              alt={stimulus}\n              src={`${this.props.stimulusImagePath}/${stimulus}.${this.props.stimulusImageExtension}`}\n            />\n          ))}\n        </div>\n        <Typography dangerouslySetInnerHTML={{ __html: marked(letter) }} />\n        <FormControl required error={error}>\n          <FormGroup>\n            {questions.map((question) => {\n              return (\n                <FormGroup key={question.label}>\n                  <FormControlLabel\n                    key={question.label}\n                    required={question.required}\n                    control={\n                      <Checkbox\n                        onChange={this.handleChange(question.label)}\n                        color=\"primary\"\n                      />\n                    }\n                    label={question.label}\n                  />\n                </FormGroup>\n              );\n            })}\n            <FormHelperText>Required consent not given.</FormHelperText>\n\n            <Button\n              onClick={this.handleSubmit}\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              Submit\n            </Button>\n          </FormGroup>\n        </FormControl>\n      </CenteredPaper>\n    );\n  }\n}\n","import React from \"react\";\nimport Stepper from \"@material-ui/core/Stepper\";\nimport Step from \"@material-ui/core/Step\";\nimport StepLabel from \"@material-ui/core/StepLabel\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\nimport \"./ExperimentProgress.css\";\n\nimport { map, sum } from \"lodash\";\nimport { connect } from \"react-redux\";\nimport { advanceWorkflowLevelTo } from \"./actions\";\n\nexport default connect(\n  (state) => ({\n    log: state.configuration,\n  }),\n  {\n    onAdvanceWorkflowLevelTo: advanceWorkflowLevelTo,\n  }\n)(\n  ({\n    log,\n    onAdvanceWorkflowLevelTo,\n    fullProgress = true,\n    currentProgress = false,\n    position = \"top\",\n  }) => {\n    //TODOLATER: shouldn't be named sections\n    var curIndex = 0;\n    var indices = [];\n    for (let i = 0; i < log.children.length; i++) {\n      if (log.children[i].noProgress) {\n        curIndex--;\n      } else {\n        indices.push(i);\n      }\n    }\n\n    let newIndex = 0;\n\n    while (log.index > indices[newIndex]) {\n      newIndex++;\n    }\n\n    let progressSections = log.children.filter((child) => !child.noProgress);\n    let sections = map(progressSections, \"label\");\n    let progress = 0;\n\n    if (currentProgress) {\n      let cur = log;\n\n      while (!cur.progressLevel) {\n        cur = cur.children[cur.index || 0];\n      }\n\n      progress = 100 * ((getCurrentChild(cur) - 1) / getAllChildren(cur));\n    }\n\n    return (\n      <React.Fragment>\n        {currentProgress && (\n          <div className={`progress ${position}`}>\n            <LinearProgress\n              style={{ height: \"8px\" }}\n              variant=\"determinate\"\n              value={progress}\n            />\n          </div>\n        )}\n        {fullProgress && (\n          <Stepper activeStep={newIndex}>\n            {sections.map((label, index) => {\n              return (\n                <Step\n                  style={{\n                    //TODOLATER: this doesn't make the cursor change on future steps.\n                    cursor: \"pointer\",\n                  }}\n                  onClick={() => {\n                    // if (process.env.NODE_ENV === \"development\") {\n                    onAdvanceWorkflowLevelTo(\"section\", indices[index]);\n                    // }\n                  }}\n                  key={label}\n                >\n                  <StepLabel>{label}</StepLabel>\n                </Step>\n              );\n            })}\n          </Stepper>\n        )}\n      </React.Fragment>\n    );\n  }\n);\n\nfunction getAllChildren(config) {\n  if (config.children) {\n    return sum(config.children.map(getAllChildren));\n  } else {\n    return 1;\n  }\n}\n\nfunction getCurrentChild(config) {\n  //BaseCase:\n  if (!config.children) {\n    return 1;\n  } else {\n    return sum(\n      config.children.slice(0, (config.index || 0) + 1).map(getCurrentChild)\n    );\n  }\n}\n","import React from \"react\";\nimport { connect } from \"react-redux\";\n\nimport { editConfig } from \"../actions/\";\nimport { Row } from \"../menus/KeyMap/KeyMap\";\nimport { bottomRows } from \"../menus/KeyMap/KeyMapConstants\";\nimport Button from \"@material-ui/core/Button\";\n\nimport \"../menus/KeyMap/KeyMap.css\";\nimport { CenteredPaper } from \"../layout\";\n\nexport class KeyboardChooser extends React.Component {\n  render() {\n    return (\n      <CenteredPaper axis=\"vertical\" width=\"1100px\">\n        <h1> Choose the bottom row of your keyboard that matches best. </h1>\n        {Object.entries(bottomRows).map(entry => (\n          <div\n            style={{ marginBottom: \"30px\" }}\n            className={`keymap active ${entry[0]}`}\n            key={entry[0]}\n          >\n            <Row\n              row={entry[1]}\n              onKeyClick={() => {}}\n              commandsAvailable={{}}\n              modifiersPressed={{}}\n            />\n            <Button\n              onClick={() => {\n                this.props.onEditConfig(\"layoutName\", entry[0]);\n                this.props.onAdvanceWorkflow();\n              }}\n              variant=\"contained\"\n              color=\"primary\"\n            >\n              Select Layout\n            </Button>\n            <br />\n          </div>\n        ))}\n      </CenteredPaper>\n    );\n  }\n}\n\nexport default connect(\n  undefined,\n  { onEditConfig: editConfig }\n)(KeyboardChooser);\n","import React from \"react\";\nimport UploadToS3 from \"./tasks/UploadToS3\";\nimport { CenteredPaper } from \"./layout\";\n\nexport class UploadOnError extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  componentDidCatch(error, info) {\n    this.setState({ hasError: true });\n    this.props.onLog(\n      \"javascriptError\",\n      JSON.stringify(error, Object.getOwnPropertyNames(error))\n    );\n    this.props.onLog(\"javscriptErrorInfo\", info);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <React.Fragment>\n          <CenteredPaper axis=\"both\" width=\"inherit\">\n            <div>\n              <h1>Something went wrong.</h1>\n              <p>\n                You can try refreshing the page. If that doesn't work please\n                message the requestor and we will arrange payment. You can also\n                email\n                <a href={`mailto:${this.props.experimenter}`}>\n                  {this.props.experimenter}\n                </a>\n              </p>\n            </div>\n          </CenteredPaper>\n\n          <UploadToS3 {...this.props} />\n        </React.Fragment>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport Button from \"@material-ui/core/Button\";\n// import CheckCircleIcon from \"@material-ui/icons/CheckCircle\";\n// import ErrorIcon from \"@material-ui/icons/Error\";\n// import InfoIcon from \"@material-ui/icons/Info\";\n// import CloseIcon from \"@material-ui/icons/Close\";\nimport green from \"@material-ui/core/colors/green\";\nimport amber from \"@material-ui/core/colors/amber\";\nimport Snackbar from \"@material-ui/core/Snackbar\";\nimport SnackbarContent from \"@material-ui/core/SnackbarContent\";\n// import WarningIcon from \"@material-ui/icons/Warning\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { Icon, IconButton } from \"@material-ui/core\";\n\nconst variantIcon = {\n  success: \"check circle\",\n  warning: \"warning\",\n  error: \"error\",\n  info: \"info\"\n};\n\nconst styles1 = theme => ({\n  success: {\n    backgroundColor: green[600]\n  },\n  error: {\n    backgroundColor: theme.palette.error.dark\n  },\n  info: {\n    backgroundColor: theme.palette.primary.dark\n  },\n  warning: {\n    backgroundColor: amber[700]\n  },\n  icon: {\n    fontSize: 20\n  },\n  iconVariant: {\n    opacity: 0.9,\n    marginRight: theme.spacing.unit\n  },\n  message: {\n    display: \"flex\",\n    alignItems: \"center\"\n  }\n});\n\nfunction MySnackbarContent(props) {\n  const { classes, className, message, onClose, variant, ...other } = props;\n\n  return (\n    <SnackbarContent\n      className={classNames(classes[variant], className)}\n      aria-describedby=\"client-snackbar\"\n      message={\n        <span id=\"client-snackbar\" className={classes.message}>\n          <Icon className={classNames(classes.icon, classes.iconVariant)}>\n            {variantIcon[variant]}\n          </Icon>\n          {message}\n        </span>\n      }\n      action={[\n        <IconButton\n          key=\"close\"\n          aria-label=\"Close\"\n          color=\"inherit\"\n          className={classes.close}\n          onClick={onClose}\n        >\n          <Icon className={classes.icon}>close</Icon>\n        </IconButton>\n      ]}\n      {...other}\n    />\n  );\n}\n\nMySnackbarContent.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  message: PropTypes.node,\n  onClose: PropTypes.func,\n  variant: PropTypes.oneOf([\"success\", \"warning\", \"error\", \"info\"]).isRequired\n};\n\nexport const MySnackbarContentWrapper = withStyles(styles1)(MySnackbarContent);\n\nconst styles2 = theme => ({\n  margin: {\n    margin: theme.spacing.unit\n  }\n});\n\nclass CustomizedSnackbars extends React.Component {\n  state = {\n    open: false\n  };\n\n  handleClick = () => {\n    this.setState({ open: true });\n  };\n\n  handleClose = (event, reason) => {\n    if (reason === \"clickaway\") {\n      return;\n    }\n\n    this.setState({ open: false });\n  };\n\n  render() {\n    const { classes } = this.props;\n\n    return (\n      <div>\n        <Button className={classes.margin} onClick={this.handleClick}>\n          Open success snackbar\n        </Button>\n        <Snackbar\n          anchorOrigin={{\n            vertical: \"bottom\",\n            horizontal: \"left\"\n          }}\n          open={this.state.open}\n          autoHideDuration={6000}\n          onClose={this.handleClose}\n        >\n          <MySnackbarContentWrapper\n            onClose={this.handleClose}\n            variant=\"success\"\n            message=\"This is a success message!\"\n          />\n        </Snackbar>\n        <MySnackbarContentWrapper\n          variant=\"error\"\n          className={classes.margin}\n          message=\"This is an error message!\"\n        />\n        <MySnackbarContentWrapper\n          variant=\"warning\"\n          className={classes.margin}\n          message=\"This is a warning message!\"\n        />\n        <MySnackbarContentWrapper\n          variant=\"info\"\n          className={classes.margin}\n          message=\"This is an information message!\"\n        />\n        <MySnackbarContentWrapper\n          variant=\"success\"\n          className={classes.margin}\n          message=\"This is a success message!\"\n        />\n      </div>\n    );\n  }\n}\n\nCustomizedSnackbars.propTypes = {\n  classes: PropTypes.object.isRequired\n};\n\nexport default withStyles(styles2)(CustomizedSnackbars);\n","import React from \"react\";\n\nimport { KeyMapDisplay } from \"../menus/KeyMap/KeyMap\";\nimport { menuToCommandHierarchy } from \"../menus/Shortcuts/CommandHierarchies\";\nimport { vegetables } from \"../data/newStimuli\";\nimport { MySnackbarContentWrapper } from \"../layout/Snackbar\";\nimport { Snackbar, Stepper, Step, StepLabel } from \"@material-ui/core\";\nimport { CenteredPaper } from \"../layout\";\n\nexport class Tutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { error: false };\n  }\n  //Could use props instead which would probs work well, whenever tyhey change record the change. I coukd makje the close button work with that too. Just reset a variable.\n  handleClose = (e, reason) => {\n    if (reason !== \"clickaway\") {\n      this.setState({ error: false });\n    }\n  };\n\n  componentWillReceiveProps(nextProps) {\n    if (nextProps.error !== this.state.error) {\n      this.setState({ error: nextProps.error });\n    }\n  }\n\n  render() {\n    const { step, steps } = this.props;\n    const { component } = steps[step];\n\n    return (\n      <React.Fragment>\n        <CenteredPaper top={this.props.top} axis=\"both\" width=\"inherit\">\n          <Stepper orientation=\"vertical\" activeStep={step}>\n            {steps.map(({ text }, index) => (\n              <Step key={text}>\n                <StepLabel>{text}</StepLabel>\n              </Step>\n            ))}\n          </Stepper>\n        </CenteredPaper>\n        {component}\n\n        <Snackbar\n          open={this.state.error}\n          autoHideDuration={5000}\n          onClose={this.handleClose}\n          anchorOrigin={{\n            vertical: \"bottom\",\n            horizontal: \"center\"\n          }}\n        >\n          <MySnackbarContentWrapper\n            onClose={this.handleClose}\n            variant=\"error\"\n            message={this.props.errorMessage}\n          />\n        </Snackbar>\n      </React.Fragment>\n    );\n  }\n}\n\nexport class KeyMapPointerTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      step: 0,\n      error: false,\n      errorMessage: \"\"\n    };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"click\", this.globalClick);\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"click\", this.globalClick);\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  keyHandler = () => {\n    this.setState({\n      error: true,\n      errorMessage: \"Try using your mouse rather than the keyboard.\"\n    });\n  };\n\n  globalClick = e => {\n    e.stopPropagation();\n\n    if (this.state.step === 1) {\n      this.setState({\n        step: 0,\n        error: true,\n        errorMessage:\n          \"You clicked somewhere other than the menu, which closes it.\"\n      });\n    }\n  };\n\n  render() {\n    let commandHierarchy = menuToCommandHierarchy(vegetables);\n    let steps = [\n      {\n        component: (\n          <KeyMapDisplay\n            onKeyClick={this.keyClick}\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n          />\n        ),\n        text: `In the bottom left are modifier buttons. Use the mouse to click the modifier button labelled shift.`\n      },\n      {\n        component: (\n          <KeyMapDisplay\n            onKeyClick={this.keyClick}\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n            modifiersPressed={{ shift: true }}\n            active\n          />\n        ),\n        text: `That opened a menu in the shape of a keyboard. Find the item carrot and click it to select it.`\n      }\n    ];\n\n    return <Tutorial top={25} steps={steps} {...this.state} />;\n  }\n\n  keyClick = (key, e) => {\n    e.nativeEvent.stopImmediatePropagation();\n    e.stopPropagation();\n\n    if (this.state.step === 1) {\n      if (key === \"c\") {\n        this.props.onAdvanceWorkflow();\n      } else {\n        this.setState({\n          error: true,\n          errorMessage:\n            \"You clicked the wrong button. You were supposed to choose carrot.\",\n          step: 0\n        });\n      }\n    } else if (this.state.step === 0) {\n      if (key === \"shift\") {\n        this.setState({ step: 1, error: false });\n      } else {\n        this.setState({\n          error: true,\n          errorMessage: \"That's the wrong modifier button.\"\n        });\n      }\n    }\n  };\n}\n\nexport class KeyMapGuidedTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { step: 0 };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  clicked = e => {\n    this.setState({\n      step: 0,\n      error: true,\n      errorMessage:\n        \"You clicked the menu, try again but use your keyboard this time.\"\n    });\n  };\n\n  delayOver = () => {\n    this.setState({ step: 1, error: false });\n    delete this.delayTimeout;\n  };\n\n  keyHandler = e => {\n    if (e.type === \"keyup\") {\n      // If they release shift in step 0 thne they didn't wait long enough.\n\n      if (this.state.step === 0 && this.delayTimeout) {\n        this.setState({\n          error: true,\n          errorMessage: \"You didn't wait long enough for the menu to appear.\"\n        });\n      }\n      clearTimeout(this.delayTimeout);\n      delete this.delayTimeout;\n      this.setState({ step: 0 });\n    } else {\n      if (e.key === \"Shift\" && !this.delayTimeout) {\n        this.delayTimeout = setTimeout(this.delayOver, 500);\n      } else if (e.key === \"C\" && this.state.step === 1) {\n        this.props.onAdvanceWorkflow();\n      } else {\n        this.setState({\n          error: true,\n          errorMessage: \"You selected something other than carrot.\"\n        });\n      }\n    }\n  };\n\n  render() {\n    let commandHierarchy = menuToCommandHierarchy(vegetables);\n    let steps = [\n      {\n        component: (\n          <KeyMapDisplay\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n            onKeyClick={this.clicked}\n          />\n        ),\n        text: `Rather than clicking the modifier button, you can press and hold shift on your keyboard and the menu will open after a short delay.`\n      },\n      {\n        component: (\n          <KeyMapDisplay\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n            modifiersPressed={{ shift: true }}\n            active\n            onKeyClick={this.clicked}\n          />\n        ),\n        text: `The key with carrot is \"C\", look in the top right of the key. Complete the selection by continuing to hold shift and also pressing C on your keyboard to select carrot.`\n      }\n    ];\n\n    return <Tutorial top={25} steps={steps} {...this.state} />;\n  }\n}\n\nexport class KeyMapShortcutTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { step: 0 };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  clicked = e => {\n    this.setState({\n      step: 0,\n      error: true,\n      errorMessage:\n        \"You clicked the menu, try again but use your keyboard this time.\"\n    });\n  };\n\n  delayOver = () => {\n    this.setState({\n      error: true,\n      errorMessage: \"You waited too long, release shift and try again.\",\n      step: 1\n    });\n    delete this.delayTimeout;\n  };\n\n  keyHandler = e => {\n    if (e.type === \"keyup\") {\n      if (e.key === \"Shift\") {\n        clearTimeout(this.delayTimeout);\n        delete this.delayTimeout;\n        if (this.state.step === 1) {\n          this.setState({ step: 0 });\n        }\n      }\n    } else {\n      if (e.key === \"Shift\") {\n        if (!this.delayTimeout) {\n          this.delayTimeout = setTimeout(this.delayOver, 500);\n        }\n      } else if (e.key === \"C\" && this.state.step === 0 && !e.repeat) {\n        this.props.onAdvanceWorkflow();\n      } else if (this.state !== 1) {\n        this.setState({\n          error: true,\n          errorMessage:\n            \"You selected something other than carrot. The carrot is shift + C.\"\n        });\n      }\n    }\n  };\n\n  render() {\n    let commandHierarchy = menuToCommandHierarchy(vegetables);\n\n    let steps = [\n      {\n        component: (\n          <KeyMapDisplay\n            onKeyClick={this.clicked}\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n          />\n        ),\n        text: `You can select carrot without waiting for the menu to appear by pressing shift and the corresponding key if you remember it. Take a guess at which key it was.`\n      },\n      {\n        component: (\n          <KeyMapDisplay\n            layoutName={this.props.layoutName}\n            commandsAvailable={commandHierarchy[\"shift\"]}\n            modifiersPressed={{ shift: true }}\n            onKeyClick={this.clicked}\n            active\n          />\n        ),\n        text: `You waited too long and the menu appeared, release shift and try again.`\n      }\n    ];\n\n    return <Tutorial top={25} steps={steps} {...this.state} />;\n  }\n}\n","import React from \"react\";\n\nimport { vegetables } from \"../data/newStimuli\";\nimport { Tutorial } from \"./KeyMapTutorial\";\nimport { LinearMenuBarDisplay } from \"../menus/LinearMenuBar/LinearMenuBar\";\n\nexport class ExposeHKPointerTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      step: 0,\n      error: false,\n      errorMessage: \"\"\n    };\n  }\n  componentDidMount() {\n    document.addEventListener(\"click\", this.globalClick);\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n  componentWillUnmount() {\n    document.removeEventListener(\"click\", this.globalClick);\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  keyHandler = () => {\n    this.setState({\n      error: true,\n      errorMessage: \"Try using your mouse rather than the keyboard.\"\n    });\n  };\n\n  globalClick = e => {\n    // e.stopPropagation();\n    if (this.state.step === 1) {\n      this.setState({\n        step: 0,\n        error: true,\n        errorMessage:\n          \"You clicked somewhere other than the menu, which closes it.\"\n      });\n    }\n  };\n\n  render() {\n    let steps = [\n      {\n        component: (\n          <LinearMenuBarDisplay\n            onMenuClick={(item, e) => {\n              e.nativeEvent.stopImmediatePropagation();\n              e.stopPropagation();\n              this.setState({ step: 1, error: false });\n            }}\n            menus={vegetables}\n          />\n        ),\n        text: `Across the top are menus. Click \"vegetables\" to open the menu.`\n      },\n      {\n        component: (\n          <LinearMenuBarDisplay\n            onMenuClick={e => {\n              this.setState({\n                step: 0,\n                error: true,\n                errorDisplay: \"You closed the menu by clicking it again.\"\n              });\n\n              e.nativeEvent.stopImmediatePropagation();\n              e.stopPropagation();\n            }}\n            menus={vegetables}\n            openMenu=\"vegetables\"\n            onItemClick={(item, e) => {\n              e.nativeEvent.stopImmediatePropagation();\n              e.stopPropagation();\n              if (item === \"carrot\") {\n                this.props.onAdvanceWorkflow();\n              } else {\n                this.setState({\n                  error: true,\n                  errorMessage:\n                    \"You clicked the wrong button. You were supposed to choose carrot.\",\n                  step: 0\n                });\n              }\n            }}\n          />\n        ),\n        text: `Now the menu is open, find the item carrot and click it to select it.`\n      }\n    ];\n\n    return <Tutorial steps={steps} {...this.state} />;\n  }\n}\n\nexport class ExposeHKGuidedTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { step: 0 };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  clicked = e => {\n    this.setState({\n      step: 0,\n      error: true,\n      errorMessage:\n        \"You clicked the menu, try again but use your keyboard this time.\"\n    });\n  };\n\n  delayOver = () => {\n    this.setState({ step: 1, error: false });\n    delete this.delayTimeout;\n  };\n\n  keyHandler = e => {\n    if (e.type === \"keyup\") {\n      // If they release shift in step 0 thne they didn't wait long enough.\n\n      if (this.state.step === 0 && this.delayTimeout) {\n        this.setState({\n          error: true,\n          errorMessage: \"You didn't wait long enough for the menu to appear.\"\n        });\n      }\n      clearTimeout(this.delayTimeout);\n      delete this.delayTimeout;\n\n      this.setState({ step: 0 });\n    } else {\n      if (e.key === \"Shift\" && !this.delayTimeout) {\n        this.delayTimeout = setTimeout(this.delayOver, 500);\n      } else if (e.key === \"C\" && this.state.step === 1) {\n        this.props.onAdvanceWorkflow();\n      } else {\n        this.setState({\n          error: true,\n          errorMessage: \"You selected something other than carrot.\"\n        });\n      }\n    }\n  };\n\n  render() {\n    let steps = [\n      {\n        component: (\n          <LinearMenuBarDisplay onMenuClick={this.clicked} menus={vegetables} />\n        ),\n        text: `Rather than clicking the menu, you can press and hold shift on your keyboard and the menu will open after a short delay.`\n      },\n      {\n        component: (\n          <LinearMenuBarDisplay\n            onItemClick={this.clicked}\n            onMenuClick={this.clicked}\n            menus={vegetables}\n            allOpen\n          />\n        ),\n        text: `Look across from carrot, it says \"shift+c\". Complete the selection by continuing to hold shift and also pressing c on your keyboard to select carrot.`\n      }\n    ];\n\n    return <Tutorial steps={steps} {...this.state} />;\n  }\n}\n\nexport class ExposeHKShortcutTutorial extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = { step: 0 };\n  }\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.keyHandler);\n    document.addEventListener(\"keydown\", this.keyHandler);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.keyHandler);\n    document.removeEventListener(\"keydown\", this.keyHandler);\n  }\n\n  clicked = e => {\n    this.setState({\n      step: 0,\n      error: true,\n      errorMessage:\n        \"You clicked the menu, try again but use your keyboard this time.\"\n    });\n  };\n\n  delayOver = () => {\n    this.setState({\n      error: true,\n      errorMessage: \"You waited too long, release shift and try again.\",\n      step: 1\n    });\n    delete this.delayTimeout;\n  };\n\n  keyHandler = e => {\n    if (e.type === \"keyup\") {\n      if (e.key === \"Shift\") {\n        clearTimeout(this.delayTimeout);\n        delete this.delayTimeout;\n        if (this.state.step === 1) {\n          this.setState({ step: 0 });\n        }\n      }\n    } else {\n      if (e.key === \"Shift\") {\n        if (!this.delayTimeout) {\n          this.delayTimeout = setTimeout(this.delayOver, 500);\n        }\n      } else if (e.key === \"C\" && this.state.step === 0 && !e.repeat) {\n        this.props.onAdvanceWorkflow();\n      } else if (this.state !== 1) {\n        this.setState({\n          error: true,\n          errorMessage:\n            \"You selected something other than carrot. The carrot is shift + C.\"\n        });\n      }\n    }\n  };\n\n  render() {\n    let steps = [\n      {\n        component: (\n          <LinearMenuBarDisplay onMenuClick={this.clicked} menus={vegetables} />\n        ),\n        text: `You can select carrot without waiting for the menu to appear by pressing shift and the corresponding key if you remember it. Take a guess at which key it was.`\n      },\n      {\n        component: (\n          <LinearMenuBarDisplay\n            onItemClick={this.clicked}\n            onMenuClick={this.clicked}\n            menus={vegetables}\n            allOpen\n          />\n        ),\n        text: `You waited too long and the menu appeared, release shift and try again.`\n      }\n    ];\n\n    return <Tutorial steps={steps} {...this.state} />;\n  }\n}\n","import React from \"react\";\nimport \"./App.css\";\nimport StimulusResponseTask from \"./tasks/StimulusResponseTask\";\nimport MouseCenteringTask from \"./tasks/MouseCenteringTask\";\nimport DisplayTextTask from \"./tasks/DisplayTextTask\";\nimport UploadToS3 from \"./tasks/UploadToS3\";\n\nimport { advanceWorkflow, log, advanceWorkflowLevelTo } from \"./actions\";\nimport { getCurrentProps } from \"./Workflow\";\nimport { connect } from \"react-redux\";\nimport GoogleFormQuestionnaire from \"./tasks/GoogleFormQuestionnaire\";\nimport ConsentForm from \"./tasks/ConsentForm\";\nimport InformationScreen from \"./tasks/InformationScreen\";\nimport ExperimentProgress from \"./ExperimentProgress\";\nimport KeyboardChooser from \"./tasks/KeyboardChooser\";\nimport { UploadOnError } from \"./UploadOnError\";\nimport {\n  KeyMapGuidedTutorial,\n  KeyMapPointerTutorial,\n  KeyMapShortcutTutorial,\n} from \"./tasks/KeyMapTutorial\";\nimport {\n  ExposeHKGuidedTutorial,\n  ExposeHKPointerTutorial,\n  ExposeHKShortcutTutorial,\n} from \"./tasks/ExposeHKTutorial\";\nconst tasks = {\n  StimulusResponseTask,\n  MouseCenteringTask,\n  DisplayTextTask,\n  ConsentForm,\n  GoogleFormQuestionnaire,\n  UploadToS3,\n  InformationScreen,\n  KeyboardChooser,\n  KeyMapGuidedTutorial,\n  KeyMapPointerTutorial,\n  KeyMapShortcutTutorial,\n  ExposeHKGuidedTutorial,\n  ExposeHKPointerTutorial,\n  ExposeHKShortcutTutorial,\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    ...getCurrentProps(state.configuration),\n    log: state.configuration,\n  };\n};\n\nconst mapDispatchToProps = {\n  onAdvanceWorkflow: advanceWorkflow,\n  onLog: log,\n  onAdvanceWorkflowLevelTo: advanceWorkflowLevelTo,\n};\n\n//TODOLATER: background tasks would be nice. Could be like middleware, where you have some function called on the task object whenever we increment and then it gets the chance to increment. Could implement non linear workflows that way. Or filtering ones.\n//TODOLATER: when losing focus we should grey out the sdcreen, or wheenver we can't capture keyboard shortcuts. Seems tough to dfo.\nexport const App = ({ task, log, ...props }) => {\n  // if (process.env.NODE_ENV === \"development\") {\n  window.onAdvanceWorkflow = props.onAdvanceWorkflow;\n\n  window.nTimes = (n) => {\n    for (var i = 0; i < n; i++) {\n      window.onAdvanceWorkflow();\n    }\n  };\n\n  window.onAdvanceWorkflowLevelTo = props.onAdvanceWorkflowLevelTo;\n  // }\n\n  if (task) {\n    //TODOLATER: there has to be a better way.\n    let Task = tasks[task];\n    return (\n      <UploadOnError\n        log={log}\n        experimenter={log.experimenter}\n        onLog={props.onLog}\n        onAdvanceWorkflow={() => {}}\n        s3FileName={`${log.participant}-ERROR.json`}\n        AWS_REGION={log.AWS_REGION}\n        AWS_S3_BUCKET={log.AWS_S3_BUCKET}\n        AWS_COGNITO_IDENTITY_POOL_ID={log.AWS_COGNITO_IDENTITY_POOL_ID}\n      >\n        <ExperimentProgress log={log} {...props} />\n        <Task {...props} />\n      </UploadOnError>\n    );\n  } else {\n    return (\n      <div>\n        <h1>You've completed the experiment!</h1>;\n        <a\n          download={`${log.participant}.json`}\n          href={`data:text/json;charset=utf-8,${JSON.stringify(log)}`}\n        >\n          Download experiment log\n        </a>\n      </div>\n    );\n  }\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n","import React from \"react\";\nimport marked from \"marked\";\n\nimport Typography from \"@material-ui/core/Typography\";\nimport Button from \"@material-ui/core/Button\";\n\nimport { CenteredPaper } from \"../layout\";\n\nexport default ({ content, withContinue, onAdvanceWorkflow }) => {\n  return (\n    <CenteredPaper axis=\"vertical\">\n      <Typography dangerouslySetInnerHTML={{ __html: marked(content) }} />\n      <br />\n      {withContinue && (\n        <Button color=\"primary\" onClick={onAdvanceWorkflow}>\n          continue\n        </Button>\n      )}\n    </CenteredPaper>\n  );\n};\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import {\n  advanceWorkflow,\n  advanceWorkflowLevelTo,\n  log,\n  logAction\n} from \"../Workflow\";\nimport {\n  LOG,\n  LOG_ACTION,\n  ADVANCE_WORKFLOW,\n  EDIT_CONFIG,\n  ADVANCE_WORKFLOW_LEVEL_TO\n} from \"../actions\";\n\nconst configuration = (state = { events: [] }, action) => {\n  switch (action.type) {\n    case ADVANCE_WORKFLOW:\n      state = { ...state };\n      advanceWorkflow(state);\n      return state;\n    case ADVANCE_WORKFLOW_LEVEL_TO:\n      state = { ...state };\n      advanceWorkflowLevelTo(state, action.level, action.newValue);\n      return state;\n    case LOG:\n      state = { ...state };\n      log(state, action.key, action.value);\n      return state;\n    case LOG_ACTION:\n      state = { ...state };\n      logAction(state, action.action, action.withTimeStamp);\n      return state;\n    case EDIT_CONFIG:\n      return { ...state, [action.key]: action.value };\n    default:\n      return state;\n  }\n};\n\nexport default configuration;\n","import {\n  ADD_TO_PATH,\n  TOGGLE_MODIFIER,\n  SET_MODIFIER,\n  RESET_SHORTCUTS,\n  DELAY_OVER\n} from \"../actions/shortcuts\";\nimport { some } from \"lodash\";\n\nconst shortcuts = (\n  state = { modifiersPressed: {}, path: [], delayTimeOver: false },\n  action\n) => {\n  let modifiersPressed;\n  let isPressed;\n  let delayTimeOver;\n  switch (action.type) {\n    //TODOLATER: deduplicate\n    case TOGGLE_MODIFIER:\n      modifiersPressed = {\n        ...state.modifiersPressed,\n        [action.modifier]: !state.modifiersPressed[action.modifier]\n      };\n      isPressed = some(Object.values(modifiersPressed), Boolean);\n      delayTimeOver = isPressed ? state.delayTimeOver : false;\n      return {\n        ...state,\n        modifiersPressed,\n        delayTimeOver\n      };\n    case SET_MODIFIER:\n      modifiersPressed = {\n        ...state.modifiersPressed,\n        [action.modifier]: action.value\n      };\n\n      isPressed = some(Object.values(modifiersPressed), Boolean);\n      delayTimeOver = isPressed ? state.delayTimeOver : false;\n\n      return {\n        ...state,\n        modifiersPressed,\n        delayTimeOver\n      };\n\n    case DELAY_OVER:\n      return {\n        ...state,\n        delayTimeOver: true\n      };\n    case RESET_SHORTCUTS:\n      return { modifiersPressed: {}, path: [], delayTimeOver: false };\n    case ADD_TO_PATH:\n      return { ...state, path: [...state.path, action.keys] };\n    default:\n      return state;\n  }\n};\n\nexport default shortcuts;\n","import { CLOSE_ALL_MENUS, OPEN_ALL_MENUS, OPEN_MENU } from \"../actions/menus\";\n\nconst shortcuts = (\n  state = { openMenu: undefined, allMenusOpen: false },\n  action\n) => {\n  switch (action.type) {\n    case CLOSE_ALL_MENUS:\n      return {\n        allMenusOpen: false,\n        openMenu: undefined\n      };\n    case OPEN_ALL_MENUS:\n      return {\n        ...state,\n        allMenusOpen: true\n      };\n    case OPEN_MENU:\n      return {\n        ...state,\n        openMenu: action.menu\n      };\n    default:\n      return state;\n  }\n};\n\nexport default shortcuts;\n","import { HIDE_STIMULUS, SHOW_STIMULUS } from \"../actions/tasks\";\n\nconst tasks = (state = { showStimulus: true }, action) => {\n  switch (action.type) {\n    case HIDE_STIMULUS:\n      return { showStimulus: false };\n    case SHOW_STIMULUS:\n      return { showStimulus: true };\n    default:\n      return state;\n  }\n};\n\nexport default tasks;\n","import { combineReducers } from \"redux\";\nimport configuration from \"./configuration\";\nimport shortcuts from \"./shortcuts\";\nimport menus from \"./menus\";\nimport tasks from \"./tasks\";\n\nexport default combineReducers({ configuration, shortcuts, menus, tasks });\n// export default combineReducers({\n//   configuration,\n//   shortcuts\n// });\n","import reducer from \"./reducers\";\nimport { logAction, log, LOG, LOG_ACTION } from \"./actions\";\nimport { createStore } from \"redux\";\nimport { throttle } from \"lodash\";\n\nconst STATE_KEY = \"state\";\n\nconst loadState = () => {\n  try {\n    const state = localStorage.getItem(STATE_KEY);\n    if (state) {\n      return JSON.parse(state);\n    }\n  } catch (err) {}\n\n  return undefined;\n};\n\nconst saveState = throttle(state => {\n  try {\n    localStorage.setItem(STATE_KEY, JSON.stringify(state));\n  } catch (err) {}\n}, 1000);\n\nexport default configuration => {\n  let storedState = undefined;\n\n  if (process.env.NODE_ENV === \"production\") {\n    storedState = loadState();\n  }\n\n  if (\n    storedState &&\n    storedState.configuration.session !== configuration.session\n  ) {\n    storedState = undefined;\n  }\n\n  let store = {};\n\n  if (process.env.NODE_ENV !== \"production\") {\n    store = createStore(\n      reducer,\n      {\n        configuration,\n        ...storedState\n      },\n      window.__REDUX_DEVTOOLS_EXTENSION__ &&\n        window.__REDUX_DEVTOOLS_EXTENSION__()\n    );\n  } else {\n    store = createStore(reducer, {\n      configuration,\n      ...storedState\n    });\n  }\n\n  store.subscribe(() => saveState(store.getState()));\n\n  let dispatch = store.dispatch;\n\n  store.dispatch = action => {\n    if ([LOG, LOG_ACTION].indexOf(action.type) === -1) {\n      dispatch(logAction(action));\n    }\n\n    if (action.type === \"ADVANCE_WORKFLOW\") {\n      dispatch(log(\"end\", new Date().getTime(), false));\n    }\n\n    dispatch(action);\n\n    if (action.type === \"ADVANCE_WORKFLOW\") {\n      dispatch(log(\"start\", new Date().getTime(), false));\n    }\n  };\n\n  return store;\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport { Provider } from \"react-redux\";\n\nimport \"./index.css\";\nimport App from \"./App\";\nimport registerServiceWorker from \"./registerServiceWorker\";\nimport configureStore from \"./configureStore\";\nimport { configuration } from \"./design/GenerateConfiguration\";\n\nimport { BrowserRouter, Switch, Route } from \"react-router-dom\";\n\nimport { pick, throttle } from \"lodash\";\n\n//TODOLATER: For the chrome extension maybe all we need to do is have an HTML page that loads an iframe from localhost. For production we can just build it and then copy manifest, maybe react-scripts build takes a folder name and we just change that and copy the manifest in with an npm script.\n\n//TODOLATER: what if we could do multiple tasks at once? And what if instead of \"progress\" being global it was one of the tasks or some other auxillary tasks? Is there a way to add tasks at different levels without overwriting?\n\n//TODOLATER: we could vastly speed up the page load by utilising more tree shaking, especially for our own tasks and modules.\n//TODOLATER: code splitting, we could just load the first section then async the rest that we need.\n//TODOLATER: we could render the html using the \"server\" I think we could do it statically at build. And then we just call hydrate instead. This would improve the bundle size a lot.\n//TODOLATER: loadable would probably help lots with this. https://github.com/jamiebuilds/react-loadable\n\n//TODOLATER: we should have some form of bundle size analysis\n\nconst store = configureStore(configuration);\nlet Experiment = (\n  <Provider store={store}>\n    <App />\n  </Provider>\n);\n\nlet Main = Experiment;\n\nReactDOM.render(\n  <React.StrictMode>{Main}</React.StrictMode>,\n  document.getElementById(\"root\")\n);\nregisterServiceWorker();\n\nwindow.addEventListener(\"mousemove\", (e) => {\n  window.mousex = e.clientX;\n  window.mousey = e.clientY;\n});\n\nlet events =\n  \"mousedown mouseup click dblclick mousemove mouseover mouseout keydown keyup keypress resize\";\nevents.split(\" \").forEach((event) => {\n  window.addEventListener(\n    event,\n    throttle((event) => logEvent(event), 200),\n    {\n      passive: true,\n    }\n  );\n});\n\nconst LOG_KEY = \"log_key\";\n\nlet loaded = localStorage.getItem(LOG_KEY);\nif (loaded) {\n  window.log = JSON.parse(loaded);\n} else {\n  window.log = [];\n}\n\nconst logEvent = (event) => {\n  window.log.push(transformEvent(event));\n  saveState();\n};\n\nconst saveState = throttle(() => {\n  window.localStorage.setItem(LOG_KEY, JSON.stringify(window.log));\n}, 5000);\n\n// mousewheel scroll resize\n//TODOLATER: add touch events here too.\nconst transformEvent = (event) => {\n  switch (event.type) {\n    case \"mousedown\":\n    case \"mouseup\":\n    case \"click\":\n    case \"dblclick\":\n    case \"mousemove\":\n    case \"mouseover\":\n    case \"mouseout\":\n      event = pick(event, [\n        \"type\",\n        \"clientX\",\n        \"clientY\",\n        \"screenX\",\n        \"screenY\",\n        \"pageX\",\n        \"pageY\",\n      ]);\n      break;\n    case \"keydown\":\n    case \"keyup\":\n    case \"keypress\":\n      event = pick(event, [\n        \"type\",\n        \"key\",\n        \"code\",\n        \"metaKey\",\n        \"shiftKey\",\n        \"altKey\",\n        \"ctrlKey\",\n      ]);\n      break;\n    case \"resize\":\n      event = {\n        width: Math.max(\n          document.documentElement.clientWidth,\n          window.innerWidth || 0\n        ),\n        height: Math.max(\n          document.documentElement.clientHeight,\n          window.innerHeight || 0\n        ),\n      };\n      break;\n    default:\n      return {};\n  }\n};\n"],"sourceRoot":""}